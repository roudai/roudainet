(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{297:function(t,e,r){"use strict";var o,h,n;r.d(e,"a",(function(){return qs})),function(t){t[t.Clockwise=0]="Clockwise",t[t.CounterClockwise=1]="CounterClockwise",t[t.Double=2]="Double"}(o||(o={})),function(t){t.Clockwise="",t.CounterClockwise="'",t.Double="2"}(h||(h={})),function(t){t.F="F",t.U="U",t.R="R",t.L="L",t.D="D",t.B="B",t.M="M",t.E="E",t.S="S",t.X="x",t.Y="y",t.Z="z"}(n||(n={}));const l=[n.F,n.U,n.R,n.L,n.D,n.B,n.M,n.E,n.S,n.X,n.Y,n.Z],c=[n.X,n.Y,n.Z],d=/([0-9]+)?([UuFfRrDdLlBbMESxyz])(w)?([2\'])?/g;function f(t){if(!t)return[];let e,r=[];for(;e=d.exec(t);){let t=e[1],o=e[2],n=e[3],l=e[4]||h.Clockwise,d=o===o.toLowerCase()&&-1===c.indexOf(o);d&&(o=o.toUpperCase());let f={unit:w(o),turnType:v(l),slices:d?2:m(t,n)};r.push(f)}return r}function m(t,e){if(e&&!t)return 2;if(!e&&t)throw new Error("Invalid move: Cannot specify num slices if outer block move indicator 'w' is not present");if(e||t){const e=parseInt(t);if(e>1)return e;throw new Error(`Invalid outer block move (${e}) must be greater than 1`)}return 1}function w(t){if(l.indexOf(t)<0)throw new Error(`Invalid move (${t}): Possible turn faces are [U R F L D B M E S x y z]`);return t}function v(t){switch(t){case h.Clockwise:return o.Clockwise;case h.CounterClockwise:return o.CounterClockwise;case h.Double:return o.Double;default:throw new Error(`Invalid move modifier (${t})`)}}class y{constructor(){this.stickers=new Map,this.faces=new Map,this.turns=new Map}addFace(t,label){if(label&&this.faces.has(label))throw`Face ${label} already exists`;label||(label=(this.faces.size+1).toString());const e=t.reduce(((t,e)=>{const r=(this.stickers.size+1).toString();return this.stickers.set(r,e),t.push(r),t}),[]);return this.faces.set(label,e),{faceId:label,stickerIds:e}}addTurn(t,label){if(label&&this.turns.has(label))throw`Turn ${label} already exists`;return label||(label=(this.turns.size+1).toString()),this.turns.set(label,t),label}doTurn(label,t=!1){const e=this.turns.get(label);if(!e)throw`Unknown turn ${label}`;let r=t?1:0,o=t?0:1,h={};e.forEach((t=>{h[t[o]]=this.stickers.get(t[o]),this.stickers.set(t[o],h[t[r]]||this.stickers.get(t[r]))}))}isSolved(){const t=this.faces.entries();let e=t.next();do{const r=e.value[1];let o=this.stickers.get(r[0]);for(let t of r)if(o!=this.stickers.get(t))return!1;e=t.next()}while(!e.done);return!0}getValues(){let t={};return this.faces.forEach(((e,r)=>{t[r]=e.map((t=>this.stickers.get(t)))})),t}setValue(t,e,r){if(!this.faces.has(t))return void console.warn(`attempting to set sticker value on invalid face: ${t}`);let o=this.faces.get(t),h=o[e];o?this.stickers.set(h,r):console.warn(`attempting to set sticker value for invalid sticker: ${t} ${e}`)}alg(t){t&&t.split(" ").forEach((t=>this.doTurn(t)))}case(t){}reset(){this.faces.forEach(((t,e)=>{t.forEach((t=>{this.stickers.set(t,e)}))}))}}const k={value:"#FFFF00"},E={value:"#FF0000"},C={value:"#0000FF"},M={value:"#FFFFFF"},R={value:"#FFA500"},F={value:"#00FF00"},S={value:"#800080"},B={value:"#808080"},L={value:"#00008B"},T={value:"#ffffb3"},I={value:"#32CD32"},x={value:"#FF69B4"},P={value:"#000000"},N={value:"#404040"};var z;!function(t){t[t.CORNER=0]="CORNER",t[t.EDGE=1]="EDGE",t[t.MIDDLE=2]="MIDDLE"}(z||(z={}));class U{constructor(t,e,r){this.x=t,this.y=e,this.z=r}static fromValues(t,e,r){return new U(t,e,r)}transformMat4(t){let e=t.values[3]*this.x+t.values[7]*this.y+t.values[11]*this.z+t.values[15];e=e||1;const r=(t.values[0]*this.x+t.values[4]*this.y+t.values[8]*this.z+t.values[12])/e,o=(t.values[1]*this.x+t.values[5]*this.y+t.values[9]*this.z+t.values[13])/e,h=(t.values[2]*this.x+t.values[6]*this.y+t.values[10]*this.z+t.values[14])/e;this.x=r,this.y=o,this.z=h}multiply(t,e,r){this.x=this.x*t,this.y=this.y*e,this.z=this.z*r}rotateX(t,e){let r=this.x-t.x,o=this.y-t.y,h=this.z-t.z;return this.x=r,this.y=o*Math.cos(e)-h*Math.sin(e),this.z=o*Math.sin(e)+h*Math.cos(e),this.x+=t.x,this.y+=t.y,this.z+=t.z,this}rotateZ(t,e){let r=this.x-t.x,o=this.y-t.y,h=this.z-t.z;return this.x=r*Math.cos(e)-o*Math.sin(e),this.y=r*Math.sin(e)+o*Math.cos(e),this.z=h,this.x+=t.x,this.y+=t.y,this.z+=t.z,this}clone(){return U.fromValues(this.x,this.y,this.z)}}class A{constructor(t,e){this.x=t,this.y=e}static fromValues(t,e){return new A(t,e)}}const V=U.fromValues(.92875,-.24803,0),O=k,W=M,j=E,D=C,$=F,X=R,G={top:O,front:j,bottom:W,left:D,right:$,back:X},_=[{type:z.CORNER,colors:[O,j,D]},{type:z.EDGE,colors:[O,D]},{type:z.CORNER,colors:[O,D,X]},{type:z.EDGE,colors:[O,X]},{type:z.CORNER,colors:[O,X,$]},{type:z.EDGE,colors:[O,$]},{type:z.CORNER,colors:[O,$,j]},{type:z.EDGE,colors:[O,j]}],H=[{type:z.EDGE,colors:[W,X]},{type:z.CORNER,colors:[W,X,D]},{type:z.EDGE,colors:[W,D]},{type:z.CORNER,colors:[W,D,j]},{type:z.EDGE,colors:[W,j]},{type:z.CORNER,colors:[W,j,$]},{type:z.EDGE,colors:[W,$]},{type:z.CORNER,colors:[W,$,X]}],Y=/((\()?(-?\d)\s*,\s*(-?\d)(\))?)|(\/)/g;function Z(t){let e,r=[];for(;e=Y.exec(t);)"/"===e[0]?r.push({slice:!0}):r.push({top:parseInt(e[3]),bottom:parseInt(e[4])});return r}const K={[z.CORNER]:2,[z.EDGE]:1};class Q extends y{constructor(t=G){super(),this.scheme=t,this.topLayer=function(t){return[{type:z.CORNER,colors:[t.top||O,t.front||j,t.left||D]},{type:z.EDGE,colors:[t.top||O,t.left||D]},{type:z.CORNER,colors:[t.top||O,t.left||D,t.back||X]},{type:z.EDGE,colors:[t.top||O,t.back||X]},{type:z.CORNER,colors:[t.top||O,t.back||X,t.right||$]},{type:z.EDGE,colors:[t.top||O,t.right||$]},{type:z.CORNER,colors:[t.top||O,t.right||$,t.front||j]},{type:z.EDGE,colors:[t.top||O,t.front||j]}]}(this.scheme),this.bottomLayer=function(t){return[{type:z.EDGE,colors:[t.bottom||W,t.back||X]},{type:z.CORNER,colors:[t.bottom||W,t.back||X,t.left||D]},{type:z.EDGE,colors:[t.bottom||W,t.left||D]},{type:z.CORNER,colors:[t.bottom||W,t.left||D,t.front||j]},{type:z.EDGE,colors:[t.bottom||W,t.front||j]},{type:z.CORNER,colors:[t.bottom||W,t.front||j,t.right||$]},{type:z.EDGE,colors:[t.bottom||W,t.right||$]},{type:z.CORNER,colors:[t.bottom||W,t.right||$,t.back||X]}]}(this.scheme),this.middleRotated=!1}alg(t){Z(t).forEach((t=>{"slice"in t?this.slice():(this.rotateTop(t.top),this.rotateBottom(t.bottom))}))}case(t){Z(t).reverse().forEach((t=>{"slice"in t?this.slice():(this.rotateTop(-1*t.top),this.rotateBottom(-1*t.bottom))}))}slice(){let t=0,e=0,r=0;for(let i=this.topLayer.length;i>0&&r<6;i--)r+=K[this.topLayer[i-1].type],t++;if(6!=r)throw"Cannot perform slice move. Top layer misaligned";r=0;for(let i=this.bottomLayer.length;i>0&&r<6;i--)r+=K[this.bottomLayer[i-1].type],e++;if(6!=r)throw"Cannot perform slice move. Bottom layer misaligned";const o=this.topLayer.splice(this.topLayer.length-t,this.topLayer.length),h=this.bottomLayer.splice(this.bottomLayer.length-e,this.bottomLayer.length);this.topLayer=this.topLayer.concat(h),this.bottomLayer=this.bottomLayer.concat(o),this.middleRotated=!this.middleRotated}rotateTop(t){const e=t;for(;0!=t;)if(t<0){const r=this.topLayer.shift(),o=K[r.type];if(Math.abs(t)<o)throw`Invalid Square1 Move. Cannot turn top layer ${e} steps`;this.topLayer.push(r),t+=o}else{const r=this.topLayer.pop(),o=K[r.type];if(Math.abs(t)<o)throw`Invalid Square1 Move. Cannot turn top layer ${e} steps`;this.topLayer.unshift(r),t-=o}}rotateBottom(t){const e=t;for(;0!=t;)if(t<0){const r=this.bottomLayer.shift(),o=K[r.type];if(Math.abs(t)<o)throw`Invalid Square1 Move. Cannot turn top layer ${e} steps`;this.bottomLayer.push(r),t+=o}else{const r=this.bottomLayer.pop(),o=K[r.type];if(Math.abs(t)<o)throw`Invalid Square1 Move. Cannot turn top layer ${e} steps`;this.bottomLayer.unshift(r),t-=o}}}const J=/([LRUB])(\'?)/g,tt={"":o.Clockwise,"'":o.CounterClockwise};function st(t){let e,r=[];for(;e=J.exec(t);){const t=e[1],o=e[2];r.push({unit:t,turnType:tt[o],slices:1})}return r}function et(t,e){return new Array(t).fill(e)}class it extends y{constructor(){super();const{stickerIds:t}=this.addFace(et(5,"top"),"top"),{stickerIds:e}=this.addFace(et(5,"front"),"front"),{stickerIds:r}=this.addFace(et(5,"right"),"right"),{stickerIds:o}=this.addFace(et(5,"bottom"),"bottom"),{stickerIds:h}=this.addFace(et(5,"back"),"back"),{stickerIds:n}=this.addFace(et(5,"left"),"left");this.addTurn([[r[0],h[0]],[r[2],h[4]],[r[3],h[1]],[r[4],h[3]],[h[0],o[0]],[h[4],o[2]],[h[1],o[3]],[h[3],o[4]],[o[0],r[0]],[o[2],r[2]],[o[3],r[3]],[o[4],r[4]],[e[4],t[2]],[t[2],n[3]],[n[3],e[4]]],"R"),this.addTurn([[ot(t),ot(n)],[at(t),at(n)],[ht(t),ht(n)],[nt(t),nt(n)],[ot(n),ot(h)],[at(n),ht(h)],[ht(n),lt(h)],[nt(n),at(h)],[ot(h),ot(t)],[ht(h),at(t)],[lt(h),ht(t)],[at(h),nt(t)],[ht(r),at(e)],[at(e),nt(o)],[nt(o),ht(r)]],"U"),this.addTurn([[ot(n),ot(e)],[nt(n),at(e)],[ht(n),lt(e)],[lt(n),nt(e)],[ot(e),ot(o)],[at(e),ht(o)],[lt(e),nt(o)],[nt(e),at(o)],[ot(o),ot(n)],[ht(o),nt(n)],[nt(o),ht(n)],[at(o),lt(n)],[lt(h),nt(t)],[nt(t),nt(r)],[nt(r),lt(h)]],"L"),this.addTurn([[ot(h),ot(n)],[ht(h),lt(n)],[nt(h),at(n)],[lt(h),nt(n)],[ot(n),ot(o)],[lt(n),lt(o)],[at(n),at(o)],[nt(n),nt(o)],[ot(o),ot(h)],[lt(o),ht(h)],[at(o),nt(h)],[nt(o),lt(h)],[at(t),nt(e)],[nt(e),lt(r)],[lt(r),at(t)]],"B")}R(t){this.doTurn("R",t)}U(t){this.doTurn("U",t)}L(t){this.doTurn("L",t)}B(t){this.doTurn("B",t)}alg(t){t&&this.doTurns(st(t))}case(t){if(!t)return;let e=st(t).reverse().map((t=>Object.assign(Object.assign({},t),{turnType:t.turnType===o.Clockwise?o.CounterClockwise:o.Clockwise})));this.doTurns(e)}doTurns(t){t.forEach((t=>{let e=t.turnType===o.CounterClockwise;switch(t.unit){case"R":this.R(e);break;case"U":this.U(e);break;case"L":this.L(e);break;case"B":this.B(e)}}))}}const ot=t=>t[0],at=t=>t[1],ht=t=>t[2],nt=t=>t[3],lt=t=>t[4],ct=/([LlRrUuBb])(\'?)/g,ut={"":o.Clockwise,"'":o.CounterClockwise};function ft(t){let e,r=[];for(;e=ct.exec(t);){const t=e[1],o=e[2];r.push({unit:t,turnType:ut[o],slices:1})}return r}class mt extends y{constructor(){super();const{stickerIds:t}=this.addFace(et(9,"top"),"top"),{stickerIds:e}=this.addFace(et(9,"left"),"left"),{stickerIds:r}=this.addFace(et(9,"right"),"right"),{stickerIds:o}=this.addFace(et(9,"back"),"back");this.addTurn([[t[8],r[8]],[r[8],e[8]],[e[8],t[8]]],"u"),this.addTurn([[e[0],o[8]],[o[8],t[4]],[t[4],e[0]]],"l"),this.addTurn([[e[4],r[0]],[r[0],o[4]],[o[4],e[4]]],"r"),this.addTurn([[r[4],t[0]],[t[0],o[0]],[o[0],r[4]]],"b"),this.addTurn([[t[5],r[5]],[t[6],r[6]],[t[7],r[7]],[t[8],r[8]],[r[5],e[5]],[r[6],e[6]],[r[7],e[7]],[r[8],e[8]],[e[5],t[5]],[e[6],t[6]],[e[7],t[7]],[e[8],t[8]]],"U"),this.addTurn([[e[0],o[8]],[e[1],o[6]],[e[2],o[5]],[e[5],o[7]],[o[8],t[4]],[o[6],t[3]],[o[5],t[7]],[o[7],t[2]],[t[4],e[0]],[t[3],e[1]],[t[7],e[2]],[t[2],e[5]]],"L"),this.addTurn([[e[2],r[5]],[e[3],r[1]],[e[4],r[0]],[e[7],r[2]],[r[5],o[2]],[r[1],o[3]],[r[0],o[4]],[r[2],o[7]],[o[2],e[2]],[o[3],e[3]],[o[4],e[4]],[o[7],e[7]]],"R"),this.addTurn([[r[2],t[5]],[r[3],t[1]],[r[4],t[0]],[r[7],t[2]],[t[5],o[5]],[t[1],o[1]],[t[0],o[0]],[t[2],o[2]],[o[5],r[2]],[o[1],r[3]],[o[0],r[4]],[o[2],r[7]]],"B")}U(t){this.doTurn("U",t)}R(t){this.doTurn("R",t)}L(t){this.doTurn("L",t)}B(t){this.doTurn("B",t)}u(t){this.doTurn("u",t)}r(t){this.doTurn("r",t)}l(t){this.doTurn("l",t)}b(t){this.doTurn("b",t)}alg(t){t&&this.doTurns(ft(t))}case(t){if(!t)return;let e=ft(t).reverse().map((t=>Object.assign(Object.assign({},t),{turnType:t.turnType===o.Clockwise?o.CounterClockwise:o.Clockwise})));this.doTurns(e)}doTurns(t){t.forEach((t=>{let e=t.turnType===o.CounterClockwise;switch(t.unit){case"R":this.R(e);break;case"r":this.r(e);break;case"U":this.U(e);break;case"u":this.u(e);break;case"L":this.L(e);break;case"l":this.l(e);break;case"B":this.B(e);break;case"b":this.b(e)}}))}}const pt=["U","R","F","dr","dl","L","d","br","BR","BL","bl","b"],bt=/([RD])([\+\+|\-\-]+)|([UFRL]|BR|BL)([2-3]?)(\'?)/g;var wt;!function(t){t.Clockwise="++",t.CounterClockwise="--",t.FaceClockwise="",t.FaceCounter="'"}(wt||(wt={}));const vt={[wt.Clockwise]:o.Clockwise,[wt.CounterClockwise]:o.CounterClockwise,[wt.FaceClockwise]:o.Clockwise,[wt.FaceCounter]:o.CounterClockwise};function gt(t){if(!t)return[];let e,r=[];for(;e=bt.exec(t);){const t=e[1]?`${e[1]}xx`:e[3],o=e[2]||e[5],h=e[4];r.push({unit:t,turnType:vt[o],slices:1,n:h?parseInt(h):1})}return r}class yt extends y{constructor(){super(),pt.forEach((t=>{this.addFace(et(11,t),t)}));const t=this.faces.get("U"),e=this.faces.get("R"),r=this.faces.get("F"),o=this.faces.get("dr"),dl=this.faces.get("dl"),h=this.faces.get("L"),n=this.faces.get("d"),br=this.faces.get("br"),l=this.faces.get("BR"),c=this.faces.get("BL"),d=this.faces.get("bl"),b=this.faces.get("b");this.addTurn([[r[2],t[6]],[r[1],t[5]],[r[10],t[4]],[t[6],l[10]],[t[5],l[9]],[t[4],l[8]],[l[10],br[8]],[l[9],br[7]],[l[8],br[6]],[br[8],o[2]],[br[7],o[1]],[br[6],o[10]],[o[2],r[2]],[o[1],r[1]],[o[10],r[10]],...kt(e)],"R"),this.addTurn([[t[2],e[2]],[t[3],e[3]],[t[4],e[4]],[e[2],o[2]],[e[3],o[3]],[e[4],o[4]],[o[2],dl[2]],[o[3],dl[3]],[o[4],dl[4]],[dl[2],h[2]],[dl[3],h[3]],[dl[4],h[4]],[h[2],t[2]],[h[3],t[3]],[h[4],t[4]],...kt(r)],"F"),this.addTurn([[r[2],h[4]],[r[3],h[5]],[r[4],h[6]],[h[4],c[8]],[h[5],c[9]],[h[6],c[10]],[c[8],l[6]],[c[9],l[7]],[c[10],l[8]],[l[6],e[10]],[l[7],e[1]],[l[8],e[2]],[e[10],r[2]],[e[1],r[3]],[e[2],r[4]],...kt(t)],"U"),this.addTurn([[r[4],dl[4]],[r[5],dl[5]],[r[6],dl[6]],[dl[4],d[8]],[dl[5],d[9]],[dl[6],d[10]],[d[8],c[6]],[d[9],c[7]],[d[10],c[8]],[c[6],t[10]],[c[7],t[1]],[c[8],t[2]],[t[10],r[4]],[t[1],r[5]],[t[2],r[6]],...kt(h)],"L"),this.addTurn([[t[6],c[10]],[t[7],c[1]],[t[8],c[2]],[c[10],b[8]],[c[1],b[9]],[c[2],b[10]],[b[8],br[4]],[b[9],br[5]],[b[10],br[6]],[br[4],e[8]],[br[5],e[9]],[br[6],e[10]],[e[8],t[6]],[e[9],t[7]],[e[10],t[8]],...kt(l)],"BR"),this.addTurn([[t[8],h[6]],[t[9],h[7]],[t[10],h[8]],[h[6],d[10]],[h[7],d[1]],[h[8],d[2]],[d[10],b[6]],[d[1],b[7]],[d[2],b[8]],[b[6],l[4]],[b[7],l[5]],[b[8],l[6]],[l[4],t[8]],[l[5],t[9]],[l[6],t[10]],...kt(c)],"BL"),this.addTurn([[r[8],e[4]],[r[9],e[5]],[r[10],e[6]],[e[4],br[8]],[e[5],br[9]],[e[6],br[10]],[br[8],n[6]],[br[9],n[7]],[br[10],n[8]],[n[6],dl[10]],[n[7],dl[1]],[n[8],dl[2]],[dl[10],r[8]],[dl[1],r[9]],[dl[2],r[10]],...kt(o)],"dr"),this.addTurn([[r[6],o[4]],[r[7],o[5]],[r[8],o[6]],[o[4],n[8]],[o[5],n[9]],[o[6],n[10]],[n[8],d[6]],[n[9],d[7]],[n[10],d[8]],[d[6],h[10]],[d[7],h[1]],[d[8],h[2]],[h[10],r[6]],[h[1],r[7]],[h[2],r[8]],...kt(dl)],"dl"),this.addTurn([[br[10],b[2]],[br[1],b[3]],[br[2],b[4]],[b[2],d[4]],[b[3],d[5]],[b[4],d[6]],[d[4],dl[8]],[d[5],dl[9]],[d[6],dl[10]],[dl[8],o[6]],[dl[9],o[7]],[dl[10],o[8]],[o[6],br[10]],[o[7],br[1]],[o[8],br[2]],...kt(n)],"d"),this.addTurn([[b[10],n[4]],[b[1],n[5]],[b[2],n[6]],[n[4],o[8]],[n[5],o[9]],[n[6],o[10]],[o[8],e[6]],[o[9],e[7]],[o[10],e[8]],[e[6],l[10]],[e[7],l[1]],[e[8],l[2]],[l[10],b[10]],[l[1],b[1]],[l[2],b[2]],...kt(br)],"br"),this.addTurn([[c[4],h[8]],[c[5],h[9]],[c[6],h[10]],[h[8],dl[6]],[h[9],dl[7]],[h[10],dl[8]],[dl[6],n[10]],[dl[7],n[1]],[dl[8],n[2]],[n[10],b[4]],[n[1],b[5]],[n[2],b[6]],[b[4],c[4]],[b[5],c[5]],[b[6],c[6]],...kt(d)],"bl"),this.addTurn([[br[2],l[2]],[br[3],l[3]],[br[4],l[4]],[l[2],c[2]],[l[3],c[3]],[l[4],c[4]],[c[2],d[2]],[c[3],d[3]],[c[4],d[4]],[d[2],n[2]],[d[3],n[3]],[d[4],n[4]],[n[2],br[2]],[n[3],br[3]],[n[4],br[4]],...kt(b)],"b"),this.addTurn([[r[0],e[0]],[r[1],e[9]],[r[5],e[3]],[r[6],e[4]],[r[7],e[5]],[r[8],e[6]],[r[9],e[7]],[r[10],e[8]],[e[0],l[0]],[e[3],l[9]],[e[4],l[10]],[e[5],l[1]],[e[6],l[2]],[e[7],l[3]],[e[8],l[4]],[e[9],l[5]],[l[0],c[0]],[l[9],c[1]],[l[10],c[2]],[l[1],c[3]],[l[2],c[4]],[l[3],c[5]],[l[4],c[6]],[l[5],c[7]],[c[0],h[0]],[c[1],h[7]],[c[2],h[8]],[c[3],h[9]],[c[4],h[10]],[c[5],h[1]],[c[6],h[2]],[c[7],h[3]],[h[0],r[0]],[h[7],r[5]],[h[8],r[6]],[h[9],r[7]],[h[10],r[8]],[h[1],r[9]],[h[2],r[10]],[h[3],r[1]],[o[0],br[0]],[o[1],br[5]],[o[2],br[6]],[o[3],br[7]],[o[4],br[8]],[o[5],br[9]],[o[6],br[10]],[o[7],br[1]],[o[8],br[2]],[o[9],br[3]],[o[10],br[4]],[br[0],b[0]],[br[1],b[3]],[br[2],b[4]],[br[3],b[5]],[br[4],b[6]],[br[5],b[7]],[br[6],b[8]],[br[7],b[9]],[br[8],b[10]],[br[9],b[1]],[br[10],b[2]],[b[0],d[0]],[b[1],d[3]],[b[2],d[4]],[b[3],d[5]],[b[4],d[6]],[b[5],d[7]],[b[6],d[8]],[b[7],d[9]],[b[8],d[10]],[b[9],d[1]],[b[10],d[2]],[d[0],dl[0]],[d[1],dl[5]],[d[2],dl[6]],[d[3],dl[7]],[d[4],dl[8]],[d[5],dl[9]],[d[6],dl[10]],[d[7],dl[1]],[d[8],dl[2]],[d[9],dl[3]],[d[10],dl[4]],[dl[0],o[0]],[dl[1],o[9]],[dl[2],o[10]],[dl[3],o[1]],[dl[4],o[2]],[dl[5],o[3]],[dl[6],o[4]],[dl[7],o[5]],[dl[8],o[6]],[dl[9],o[7]],[dl[10],o[8]],...kt(n)],"D++"),this.addTurn([[r[0],t[0]],[r[7],t[3]],[r[8],t[4]],[r[9],t[5]],[r[10],t[6]],[r[1],t[7]],[r[2],t[8]],[r[3],t[9]],[t[0],c[0]],[t[3],c[9]],[t[4],c[10]],[t[5],c[1]],[t[6],c[2]],[t[7],c[3]],[t[8],c[4]],[t[9],c[5]],[c[0],d[0]],[c[9],d[1]],[c[10],d[2]],[c[1],d[3]],[c[2],d[4]],[c[3],d[5]],[c[4],d[6]],[c[5],d[7]],[d[0],dl[0]],[d[1],dl[7]],[d[2],dl[8]],[d[3],dl[9]],[d[4],dl[10]],[d[5],dl[1]],[d[6],dl[2]],[d[7],dl[3]],[dl[0],r[0]],[dl[7],r[7]],[dl[8],r[8]],[dl[9],r[9]],[dl[10],r[10]],[dl[1],r[1]],[dl[2],r[2]],[dl[3],r[3]],[o[0],e[0]],[o[1],e[9]],[o[2],e[10]],[o[3],e[1]],[o[4],e[2]],[o[5],e[3]],[o[6],e[4]],[o[7],e[5]],[o[8],e[6]],[o[9],e[7]],[o[10],e[8]],[e[0],l[0]],[e[1],l[5]],[e[2],l[6]],[e[3],l[7]],[e[4],l[8]],[e[5],l[9]],[e[6],l[10]],[e[7],l[1]],[e[8],l[2]],[e[9],l[3]],[e[10],l[4]],[l[0],b[0]],[l[1],b[1]],[l[2],b[2]],[l[3],b[3]],[l[4],b[4]],[l[5],b[5]],[l[6],b[6]],[l[7],b[7]],[l[8],b[8]],[l[9],b[9]],[l[10],b[10]],[b[0],n[0]],[b[1],n[5]],[b[2],n[6]],[b[3],n[7]],[b[4],n[8]],[b[5],n[9]],[b[6],n[10]],[b[7],n[1]],[b[8],n[2]],[b[9],n[3]],[b[10],n[4]],[n[0],o[0]],[n[1],o[5]],[n[2],o[6]],[n[3],o[7]],[n[4],o[8]],[n[5],o[9]],[n[6],o[10]],[n[7],o[1]],[n[8],o[2]],[n[9],o[3]],[n[10],o[4]],...kt(br)],"R++")}U(t){this.doTurn("U",t)}R(t){this.doTurn("R",t)}F(t){this.doTurn("F",t)}dr(t){this.doTurn("dr",t)}dl(t){this.doTurn("dl",t)}L(t){this.doTurn("L",t)}d(t){this.doTurn("d",t)}br(t){this.doTurn("br",t)}BR(t){this.doTurn("BR",t)}BL(t){this.doTurn("BL",t)}bl(t){this.doTurn("bl",t)}b(t){this.doTurn("b",t)}Dxx(t){this.doTurn("D++",t)}Rxx(t){this.doTurn("R++",t)}alg(t){t&&this.doTurns(gt(t))}case(t){if(!t)return;let e=gt(t).reverse().map((t=>Object.assign(Object.assign({},t),{turnType:t.turnType===o.Clockwise?o.CounterClockwise:o.Clockwise})));this.doTurns(e)}doTurns(t){t.forEach((t=>{let e,r=t.turnType===o.CounterClockwise;switch(t.unit){case"Rxx":e=this.Rxx.bind(this);break;case"Dxx":e=this.Dxx.bind(this);break;case"U":e=this.U.bind(this);break;case"R":e=this.R.bind(this);break;case"F":e=this.F.bind(this);break;case"L":e=this.L.bind(this);break;case"BL":e=this.BL.bind(this);break;case"BR":e=this.BR.bind(this)}for(let i=t.n;i>0;i--)e(r)}))}}function kt(t){return[[t[1],t[9]],[t[9],t[7]],[t[7],t[5]],[t[5],t[3]],[t[3],t[1]],[t[2],t[10]],[t[10],t[8]],[t[8],t[6]],[t[6],t[4]],[t[4],t[2]]]}var Et;!function(t){t.U="U",t.R="R",t.F="F",t.D="D",t.L="L",t.B="B"}(Et||(Et={}));const Ct=[Et.U,Et.R,Et.F,Et.D,Et.L,Et.B];var Mt;!function(t){t.X="X",t.Y="Y",t.Z="Z"}(Mt||(Mt={}));const Rt={X:[Et.U,Et.B,Et.D,Et.F],Y:[Et.L,Et.B,Et.R,Et.F],Z:[Et.L,Et.U,Et.R,Et.D]},Ft={X:{[Et.U]:0,[Et.B]:2,[Et.F]:0,[Et.D]:0},Y:{[Et.B]:-1,[Et.F]:-1,[Et.L]:-1,[Et.R]:-1},Z:{[Et.U]:-1,[Et.D]:1,[Et.L]:2,[Et.R]:0}},St={[Et.U]:!1,[Et.R]:!1,[Et.F]:!1,[Et.D]:!0,[Et.L]:!0,[Et.B]:!0};function Bt(t){return Math.PI*t/180}function Lt(t,e){const r=t*Math.cos(e),o=t*Math.sin(e);return A.fromValues(r,o)}function Tt(t){return t/2*Math.sqrt(2.5+1.1*Math.sqrt(5))}function It(t){let e=0,r=0,o=0;return t.forEach((t=>{e+=t.x,r+=t.y,o+=t.z})),e/=t.length,r/=t.length,o/=t.length,U.fromValues(e,r,o)}class xt extends y{constructor(t){super(),this.size=t,this.gridSize=t*t,Ct.forEach((t=>{this.addFace(et(this.gridSize,t),t);const e=this.makeFaceTurnDefinitions(t);this.addTurn(e,t)})),[Mt.X,Mt.Y,Mt.Z].forEach((t=>{for(let e=0;e<this.size;e++){let r=[];Rt[t].forEach(((o,i)=>{const h=Rt[t][(i+1)%Rt[t].length],n=this.faces.get(h),l=this.faces.get(o);for(let c=0;c<this.size;c++){const d=this.size*c+e,f=l[this.axisAlignedSticker(t,o,d)],m=n[this.axisAlignedSticker(t,h,d)];r.push([f,m])}})),this.addTurn(r,`${t}-${e}`)}}))}makeFaceTurnDefinitions(t){const e=this.faces.get(t);return e.map(((t,i)=>[t,e[this.clockwiseSticker(i)]]))}clockwiseSticker(t){return(t+1)*this.size%(this.gridSize+1)-1}counterClockwiseSticker(t){return this.oppositeSticker(this.clockwiseSticker(t))}oppositeSticker(t){return this.gridSize-(t+1)}axisAlignedSticker(t,e,r){switch(Ft[t][e]){case 0:return r;case 1:return this.clockwiseSticker(r);case 2:return this.oppositeSticker(r);case-1:return this.counterClockwiseSticker(r);default:throw`Invalid axis face orientation value ${Ft[t][e]}`}}turnFace(t,e,r,o,h){Math.abs(h-o)>=this.size-1?console.error(`Invalid number of layers to turn, skipping turn.; face=${t}, layers=${Math.abs(h-o)+1}`):(this.doTurn(t,r),function(t,e){if(t===e)return[t];const r=t<e?1:-1;let o=[];for(let h=t;h!=e;h+=r)o.push(h);return o.push(e),o}(o,h).forEach((o=>{this.doTurn(`${e}-${o}`,St[t]?!r:r)})))}U(t=!1,e=1){this.turnFace(Et.U,Mt.Y,t,this.size-1,this.size-e)}R(t=!1,e=1){this.turnFace(Et.R,Mt.X,t,this.size-1,this.size-e)}F(t=!1,e=1){this.turnFace(Et.F,Mt.Z,t,0,e-1)}D(t=!1,e=1){this.turnFace(Et.D,Mt.Y,t,0,e-1)}L(t=!1,e=1){this.turnFace(Et.L,Mt.X,t,0,e-1)}B(t=!1,e=1){this.turnFace(Et.B,Mt.Z,t,this.size-1,this.size-e)}M(t=!1){for(let e=1;e<this.size-1;e++)this.doTurn(`${Mt.X}-${e}`,!t)}S(t=!1){for(let e=1;e<this.size-1;e++)this.doTurn(`${Mt.Z}-${e}`,t)}E(t=!1){for(let e=1;e<this.size-1;e++)this.doTurn(`${Mt.Y}-${e}`,!t)}X(t=!1){this.doTurn("R",t),this.doTurn("L",!t);for(let e=0;e<this.size;e++)this.doTurn(`${Mt.X}-${e}`,t)}Y(t=!1){this.doTurn("U",t),this.doTurn("D",!t);for(let e=0;e<this.size;e++)this.doTurn(`${Mt.Y}-${e}`,t)}Z(t=!1){this.doTurn("F",t),this.doTurn("B",!t);for(let e=0;e<this.size;e++)this.doTurn(`${Mt.Z}-${e}`,t)}alg(t){t&&this.doTurns(f(t))}case(t){if(!t)return;let e=f(t).reverse().map((t=>{switch(t.turnType){case o.Clockwise:t.turnType=o.CounterClockwise;break;case o.CounterClockwise:t.turnType=o.Clockwise;case o.Double:}return t}));this.doTurns(e)}doTurns(t){t.forEach((t=>{let e;switch(t.unit){case n.U:e=this.U.bind(this);break;case n.R:e=this.R.bind(this);break;case n.F:e=this.F.bind(this);break;case n.D:e=this.D.bind(this);break;case n.L:e=this.L.bind(this);break;case n.B:e=this.B.bind(this);break;case n.M:e=this.M.bind(this);break;case n.E:e=this.E.bind(this);break;case n.S:e=this.S.bind(this);break;case n.X:e=this.X.bind(this);break;case n.Y:e=this.Y.bind(this);break;case n.Z:e=this.Z.bind(this);break;default:console.warn("Unsupported cube move",t)}const r=t.turnType===o.CounterClockwise;e(r,t.slices),t.turnType===o.Double&&e(r,t.slices)}))}}const Pt=(()=>{let t=0;return function(){return t++}})();class Nt{constructor(t){Array.isArray(t)&&16==t.length?this.values=t:this.values=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}static fromValues(t,e,r,o,h,n,l,c,d,f,m,w,v,y,k,E){return new Nt([t,e,r,o,h,n,l,c,d,f,m,w,v,y,k,E])}static fromQuaternion(q){let{a:t,b:e,c:r,d:o}=q,h=t+t,n=e+e,l=r+r,c=t*h,d=e*h,f=e*n,m=r*h,w=r*n,v=r*l,y=o*h,k=o*n,E=o*l;return Nt.fromValues(1-f-v,d+E,m-k,0,d-E,1-c-v,w+y,0,m+k,w-y,1-c-f,0,0,0,0,1)}static fromTranslation(t,e,r){return Nt.fromValues(1,0,0,0,0,1,0,0,0,0,1,0,t,e,r,1)}static fromXRotation(t){let s=Math.sin(t),e=Math.cos(t);return Nt.fromValues(1,0,0,0,0,e,s,0,0,-s,e,0,0,0,0,1)}static fromYRotation(t){let s=Math.sin(t),e=Math.cos(t);return Nt.fromValues(e,0,-s,0,0,1,0,0,s,0,e,0,0,0,0,1)}static copy(t,e){t.values[0]=e.values[0],t.values[1]=e.values[1],t.values[2]=e.values[2],t.values[3]=e.values[3],t.values[4]=e.values[4],t.values[5]=e.values[5],t.values[6]=e.values[6],t.values[7]=e.values[7],t.values[8]=e.values[8],t.values[9]=e.values[9],t.values[10]=e.values[10],t.values[11]=e.values[11],t.values[12]=e.values[12],t.values[13]=e.values[13],t.values[14]=e.values[14],t.values[15]=e.values[15]}static multiply(t,a,b){let e=a.values[0],r=a.values[1],o=a.values[2],h=a.values[3],n=a.values[4],l=a.values[5],c=a.values[6],d=a.values[7],f=a.values[8],m=a.values[9],w=a.values[10],v=a.values[11],y=a.values[12],k=a.values[13],E=a.values[14],C=a.values[15],M=b.values[0],R=b.values[1],F=b.values[2],S=b.values[3];return t.values[0]=M*e+R*n+F*f+S*y,t.values[1]=M*r+R*l+F*m+S*k,t.values[2]=M*o+R*c+F*w+S*E,t.values[3]=M*h+R*d+F*v+S*C,M=b.values[4],R=b.values[5],F=b.values[6],S=b.values[7],t.values[4]=M*e+R*n+F*f+S*y,t.values[5]=M*r+R*l+F*m+S*k,t.values[6]=M*o+R*c+F*w+S*E,t.values[7]=M*h+R*d+F*v+S*C,M=b.values[8],R=b.values[9],F=b.values[10],S=b.values[11],t.values[8]=M*e+R*n+F*f+S*y,t.values[9]=M*r+R*l+F*m+S*k,t.values[10]=M*o+R*c+F*w+S*E,t.values[11]=M*h+R*d+F*v+S*C,M=b.values[12],R=b.values[13],F=b.values[14],S=b.values[15],t.values[12]=M*e+R*n+F*f+S*y,t.values[13]=M*r+R*l+F*m+S*k,t.values[14]=M*o+R*c+F*w+S*E,t.values[15]=M*h+R*d+F*v+S*C,t}static perspective(t,e,r,o){const h=1/Math.tan(t/2),n=[h/e,0,0,0,0,h,0,0,0,0,0,-1,0,0,0,0];if(null!=o&&o!==1/0){const t=1/(r-o);n[10]=(o+r)*t,n[14]=2*o*r*t}else n[10]=-1,n[14]=-2*r;return new Nt(n)}translate(t,e,r){this.values[12]=this.values[0]*t+this.values[4]*e+this.values[8]*r+this.values[12],this.values[13]=this.values[1]*t+this.values[5]*e+this.values[9]*r+this.values[13],this.values[14]=this.values[2]*t+this.values[6]*e+this.values[10]*r+this.values[14],this.values[15]=this.values[3]*t+this.values[7]*e+this.values[11]*r+this.values[15]}scale(t,e,r){this.values[0]=this.values[0]*t,this.values[1]=this.values[1]*t,this.values[2]=this.values[2]*t,this.values[3]=this.values[3]*t,this.values[4]=this.values[4]*e,this.values[5]=this.values[5]*e,this.values[6]=this.values[6]*e,this.values[7]=this.values[7]*e,this.values[8]=this.values[8]*r,this.values[9]=this.values[9]*r,this.values[10]=this.values[10]*r,this.values[11]=this.values[11]*r}rotate(t,e,r,o){let h=Math.hypot(e,r,o);if(h<1e-6)return;h=1/h,e*=h,r*=h,o*=h;let n,l,c,d,f,m,w,v,y,k,E,C,M,R,F,S,B,L,T,I,x,s=Math.sin(t),P=Math.cos(t),N=1-P;n=this.values[0],l=this.values[1],c=this.values[2],d=this.values[3],f=this.values[4],m=this.values[5],w=this.values[6],v=this.values[7],y=this.values[8],k=this.values[9],E=this.values[10],C=this.values[11],M=e*e*N+P,R=r*e*N+o*s,F=o*e*N-r*s,S=e*r*N-o*s,B=r*r*N+P,L=o*r*N+e*s,T=e*o*N+r*s,I=r*o*N-e*s,x=o*o*N+P,this.values[0]=n*M+f*R+y*F,this.values[1]=l*M+m*R+k*F,this.values[2]=c*M+w*R+E*F,this.values[3]=d*M+v*R+C*F,this.values[4]=n*S+f*B+y*L,this.values[5]=l*S+m*B+k*L,this.values[6]=c*S+w*B+E*L,this.values[7]=d*S+v*B+C*L,this.values[8]=n*T+f*I+y*x,this.values[9]=l*T+m*I+k*x,this.values[10]=c*T+w*I+E*x,this.values[11]=d*T+v*I+C*x}multiply(b){Nt.multiply(this,this,b)}}class zt{constructor(){this.uid=Pt(),this.matrix=new Nt,this.centroid=U.fromValues(0,0,0)}translate(t,e,r){this.matrix.translate(t,e,r)}rotate(t,e,r,o){this.matrix.rotate(t,e,r,o)}scale(t,e,r){this.matrix.scale(t,e,r)}setColor(t){this.color=t}}class Ut extends zt{constructor(t=[]){super(),this.setObjects(t)}setObjects(t){this.objects=t}addObject(object){this.objects.push(object)}setCentroid(t){this.centroid=t}}const At=Math.sqrt(3),Vt=Math.atan(Bt(15)),Ot=Bt(30),Wt=(Bt(36),Bt(60));Bt(72);class jt{constructor(t=_,e=H,r=!1,o=G,h=.7){this.scheme=o,this.sideLength=h,this.halfSide=this.sideLength/2,this.halfEdgePiece=this.halfSide*Vt,this.layerWidth=this.halfSide-this.halfEdgePiece,this.middleWidth=this.sideLength-2*this.layerWidth,this.halfMiddleWidth=this.middleWidth/2,this.borderLayerWidth=.2*this.sideLength,this.outerHalfSide=(h+this.borderLayerWidth)/2,this.outerHalfEdgePiece=this.outerHalfSide*Vt,this.pieces=this.buildSquare1(t,e,r),this.group=new Ut(this.pieces)}makeLayer(t){let e=[],r=Math.PI;return t.forEach(((t,o)=>{switch(t.type){case z.CORNER:const o=this.square1Corner(t.colors[0],t.colors[1],t.colors[2]);o.rotate(r,0,0,1),e.push(o),r-=Wt;break;case z.EDGE:const h=this.square1Edge(t.colors[0],t.colors[1]);h.rotate(r-Wt,0,0,1),e.push(h),r-=Ot}})),e}setColors(t){}}class Dt{constructor(t,e,r){this.indices=t,this.color=r,this.uid=Pt(),e&&this.calculateCentroid(e)}calculateCentroid(t){this.centroid=It(t.filter(((t,i)=>this.indices.includes(i))))}}class $t extends zt{constructor(t,e){super(),this.vertices=t,this.faces=e,this.centroid=It(this.vertices)}}class Xt extends jt{constructor(t=_,e=H,r=!1,o=G,h=.7){super(t,e,r,o,h)}square1Corner(t,e,r){const o=[U.fromValues(0,0,0),U.fromValues(this.halfSide,this.halfEdgePiece,0),U.fromValues(this.halfSide,this.halfSide,0),U.fromValues(this.halfEdgePiece,this.halfSide,0),U.fromValues(this.outerHalfSide,this.outerHalfEdgePiece,0),U.fromValues(this.outerHalfSide,this.outerHalfSide,0),U.fromValues(this.outerHalfEdgePiece,this.outerHalfSide,0)],h=[new Dt([0,1,2,3],o,t),new Dt([2,3,6,5],o,e),new Dt([1,2,5,4],o,r)];return new $t(o,h)}square1Edge(t,e){const r=[U.fromValues(0,0,0).rotateZ(U.fromValues(0,0,0),Ot),U.fromValues(this.halfEdgePiece,this.halfSide,0).rotateZ(U.fromValues(0,0,0),Ot),U.fromValues(-this.halfEdgePiece,this.halfSide,0).rotateZ(U.fromValues(0,0,0),Ot),U.fromValues(this.outerHalfEdgePiece,this.outerHalfSide,0).rotateZ(U.fromValues(0,0,0),Ot),U.fromValues(-this.outerHalfEdgePiece,this.outerHalfSide,0).rotateZ(U.fromValues(0,0,0),Ot)],o=[new Dt([0,1,2],r,t),new Dt([1,2,4,3],r,e)];return new $t(r,o)}square1Middle(t,e,r,o){const h=this.halfSide-this.halfEdgePiece,n=(this.sideLength-2*h)/2,l=this.outerHalfSide-this.outerHalfEdgePiece,c=[U.fromValues(-this.outerHalfSide,n,-.01),U.fromValues(-this.outerHalfEdgePiece,n,-.01),U.fromValues(this.outerHalfSide,n,-.01),U.fromValues(-this.outerHalfSide,-n,-.01),U.fromValues(-this.outerHalfEdgePiece,-n,-.01),U.fromValues(this.outerHalfSide,-n,-.01),U.fromValues(2*this.outerHalfEdgePiece,n,-.01),U.fromValues(2*this.outerHalfEdgePiece,-n,-.01),U.fromValues(2*l,n,-.01),U.fromValues(2*l,-n,-.01)],d=[new Dt([0,1,4,3],c,t)];return o?(d.push(new Dt([1,6,7,4],c,r)),d.push(new Dt([6,8,9,7],c,e))):d.push(new Dt([1,2,5,4],c,t)),new $t(c,d)}buildSquare1(t,e,r){const o=this.halfSide-this.halfEdgePiece,h=(this.sideLength-2*o)/2;let n=[];const l=new Ut(this.makeLayer(t)),c=new Ut(this.makeLayer(e));l.translate(0,this.outerHalfSide+h,0),c.translate(0,-(this.outerHalfSide+h),0),c.rotate(Ot,0,0,1),n=[l,c];const d=this.scheme.front||G.front,f=this.scheme.left||G.left,m=this.scheme.back||G.back,w=this.square1Middle(d,f,m,r);return this.faces={top:l,bottom:c},n.push(w),n}}const Gt={value:"#333",stroke:"#333"};class _t extends jt{constructor(t=_,e=H,r=!1,o=G,h=1.25){super(t,e,r,o,h)}square1Corner(t,e,r){const o=[U.fromValues(0,0,this.halfSide),U.fromValues(this.halfSide,this.halfEdgePiece,this.halfSide),U.fromValues(this.halfSide,this.halfSide,this.halfSide),U.fromValues(this.halfEdgePiece,this.halfSide,this.halfSide),U.fromValues(0,0,this.halfSide-this.layerWidth),U.fromValues(this.halfSide,this.halfEdgePiece,this.halfSide-this.layerWidth),U.fromValues(this.halfSide,this.halfSide,this.halfSide-this.layerWidth),U.fromValues(this.halfEdgePiece,this.halfSide,this.halfSide-this.layerWidth)],h=[new Dt([0,1,2,3],o,t),new Dt([4,5,6,7],o,Gt),new Dt([0,1,5,4],o,Gt),new Dt([2,3,7,6],o,e),new Dt([1,2,6,5],o,r),new Dt([0,3,7,4],o,Gt)],n=U.fromValues(this.halfSide/2,this.halfSide/2,this.halfSide/2);return h[1].centroid=n,h[2].centroid=n,h[5].centroid=n,new $t(o,h)}square1Edge(t,e){const r=[U.fromValues(0,0,this.halfSide).rotateZ(U.fromValues(0,0,0),Ot),U.fromValues(this.halfEdgePiece,this.halfSide,this.halfSide).rotateZ(U.fromValues(0,0,0),Ot),U.fromValues(-this.halfEdgePiece,this.halfSide,this.halfSide).rotateZ(U.fromValues(0,0,0),Ot),U.fromValues(0,0,this.halfSide-this.layerWidth).rotateZ(U.fromValues(0,0,0),Ot),U.fromValues(this.halfEdgePiece,this.halfSide,this.halfSide-this.layerWidth).rotateZ(U.fromValues(0,0,0),Ot),U.fromValues(-this.halfEdgePiece,this.halfSide,this.halfSide-this.layerWidth).rotateZ(U.fromValues(0,0,0),Ot)],o=[new Dt([0,1,2],r,t),new Dt([3,4,5],r,Gt),new Dt([1,2,5,4],r,e),new Dt([0,1,4,3],r,Gt),new Dt([0,2,5,3],r,Gt)],h=U.fromValues(0,this.halfSide/2,this.halfSide/2).rotateZ(U.fromValues(0,0,0),Ot);return o[1].centroid=h,o[3].centroid=h,o[4].centroid=h,new $t(r,o)}square1Middle(t,e,r){const o=[U.fromValues(-this.halfSide,-this.halfSide,this.halfMiddleWidth),U.fromValues(-this.halfSide,this.halfSide,this.halfMiddleWidth),U.fromValues(this.halfEdgePiece,this.halfSide,this.halfMiddleWidth),U.fromValues(-this.halfEdgePiece,-this.halfSide,this.halfMiddleWidth),U.fromValues(-this.halfSide,-this.halfSide,-this.halfMiddleWidth),U.fromValues(-this.halfSide,this.halfSide,-this.halfMiddleWidth),U.fromValues(this.halfEdgePiece,this.halfSide,-this.halfMiddleWidth),U.fromValues(-this.halfEdgePiece,-this.halfSide,-this.halfMiddleWidth)],h=[new Dt([0,1,2,3],o,{value:"#333"}),new Dt([4,5,6,7],o,{value:"#333"}),new Dt([0,1,5,4],o,e),new Dt([1,2,6,5],o,r),new Dt([0,3,7,4],o,t)],n=U.fromValues(-this.halfSide/2,0,0);return h[0].centroid=n,h[1].centroid=n,h[2].centroid=U.fromValues(-(this.halfSide+.45*this.halfSide),0,0),new $t(o,h)}buildSquare1(t,e,r){const o=new Ut(this.makeLayer(t)),h=new Ut(this.makeLayer(e));h.rotate(Math.PI,1,0,0),h.rotate(Ot,0,0,1);const n=[o,h],l=this.scheme.front||G.front,c=this.scheme.left||G.left,d=this.scheme.back||G.back,f=this.scheme.right||G.right,m=this.square1Middle(l,c,d),w=this.square1Middle(d,f,l);return w.rotate(Math.PI,0,0,1),r&&w.rotate(Math.PI,V.x,V.y,V.z),n.push(m),n.push(w),this.faces={top:o,bottom:h},n}}class Ht extends $t{constructor(t,e,r){let o=[U.fromValues(0,0,0),U.fromValues(t,0,0),U.fromValues(t,-e,0),U.fromValues(0,-e,0)];super(o,[new Dt([0,1,2,3],o,r)])}}class Yt extends $t{constructor(a,b,t,e){let r=[a,b,t];super(r,[new Dt([0,1,2],r,e)])}}class qt{constructor(){const t=Math.sqrt(2*Math.pow(.5,2)),e=new Ut(this.makeStickers(R,t,U.fromValues(-1,0,0))),r=new Ut(this.makeStickers(F,t,U.fromValues(2,0,0))),o=new Ut(this.makeStickers(M,t,U.fromValues(0,-1,0))),h=new Ut(this.makeStickers(E,t,U.fromValues(1,0,0))),n=new Ut(this.makeStickers(k,t,U.fromValues(0,1,0))),l=new Ut(this.makeStickers(C,t,U.fromValues(0,0,0)));this.U=n,this.R=h,this.F=l,this.L=e,this.B=r,this.D=o,this.faces={top:this.U,front:this.F,right:this.R,back:this.B,left:this.L,bottom:this.D},this.stickers=[h,n,l,e,r,o],this.group=new Ut(this.stickers),this.group.translate(-1/4,0,0),this.group.scale(.5,.5,.5)}makeStickers(t,e,r){const o=new Ht(e,e,t);o.translate(r.x,r.y,r.z),o.rotate(Math.PI/4,0,0,1),o.translate(-e/2,e/2,0);const h=[];for(let i=0;i<4;i++){const o=new Yt(U.fromValues(-e/2,e/2,0),U.fromValues(0,e,0),U.fromValues(e/2,e/2,0),t);o.translate(r.x,r.y,r.z),o.rotate(-Math.PI/2*i,0,0,1),o.rotate(Math.PI/4,0,0,1),h.push(o)}return[o,...h]}setColors(t){let{top:e,right:r,front:o,bottom:h,left:n,back:l}=t;this.setFaceColors(this.U,e),this.setFaceColors(this.R,r),this.setFaceColors(this.F,o),this.setFaceColors(this.D,h),this.setFaceColors(this.L,n),this.setFaceColors(this.B,l)}setFaceColors(t,e=[]){t.objects[0].faces[0].color=e[0]||P,t.objects[1].faces[0].color=e[1]||P,t.objects[2].faces[0].color=e[2]||P,t.objects[3].faces[0].color=e[4]||P,t.objects[4].faces[0].color=e[3]||P}}class Zt{constructor(){const t=Math.sqrt(2*Math.pow(.625,2)),e=.625,r=new Ut(this.makeStickers(E,t)),o=new Ut(this.makeStickers(k,t,U.fromValues(1,0,0))),h=new Ut(this.makeStickers(C,t,U.fromValues(0,1,0))),n=new Ut(this.makeStickers(R,t)),l=new Ut(this.makeStickers(F,t,U.fromValues(0,1,0))),c=new Ut(this.makeStickers(M,t,U.fromValues(1,0,0)));this.U=o,this.R=r,this.F=h,this.L=n,this.B=l,this.D=c,this.faces={top:this.U,front:this.F,right:this.R,back:this.B,left:this.L,bottom:this.D},r.translate(0,0,e),r.rotate(Math.PI,1,0,0),r.rotate(Math.PI/2,0,0,1),n.rotate(-Math.PI/2,0,0,1),n.translate(0,0,-.625),h.rotate(-Math.PI/2,1,0,0),h.translate(-.625,0,0),l.translate(e,0,0),l.rotate(Math.PI,0,1,0),l.rotate(-Math.PI/2,1,0,0),o.rotate(Math.PI,0,1,0),o.translate(0,e,0),c.translate(0,-.625,0),c.rotate(Math.PI,1,0,0),this.stickers=[r,o,h,n,l,c],this.group=new Ut(this.stickers)}makeStickers(t,e,r){const o=new Ht(e,e,t);r&&o.rotate(Math.PI/2,r.x,r.y,r.z),o.rotate(Math.PI/4,0,0,1),o.translate(-e/2,e/2,0);const h=[];for(let i=0;i<4;i++){const o=new Yt(U.fromValues(-e/2,e/2,0),U.fromValues(0,e,0),U.fromValues(e/2,e/2,0),t);r&&o.rotate(Math.PI/2,r.x,r.y,r.z),o.rotate(Math.PI/2*i,0,0,1),o.rotate(Math.PI/4,0,0,1),h.push(o)}return[o,...h]}setColors(t){let{top:e,right:r,front:o,bottom:h,left:n,back:l}=t;this.setFaceColors(this.U,e),this.setFaceColors(this.R,r),this.setFaceColors(this.F,o),this.setFaceColors(this.D,h),this.setFaceColors(this.L,n),this.setFaceColors(this.B,l)}setFaceColors(t,e=[]){t.objects[0].faces[0].color=e[0]||P,t.objects[1].faces[0].color=e[1]||P,t.objects[2].faces[0].color=e[2]||P,t.objects[3].faces[0].color=e[4]||P,t.objects[4].faces[0].color=e[3]||P}}class Kt extends $t{constructor(base,t,e){const r=base/2,o=base*(At/2),h=base/t,n=o/t,l=o/3;let c=[],d=[],f=0;for(let o=0;o<=t;o++)for(let m=0,w=t-o;m<=w;m++){const t=h*m+o*h/2+-r,v=n*o+-l;c.push(U.fromValues(t,v,0)),o>0&&(m>0&&d.push(new Dt([f,f-1,f-w-2],null,e)),d.push(new Dt([f,f-w-2,f-w-1],null,e))),f++}d.forEach((t=>t.calculateCentroid(c))),super(c,d)}}const Qt=60*Math.PI/180;class Jt{constructor(t,e=.925){this.size=t;const r=e*(At/2)/1.5,o=.1*r,h=new Kt(e,t,k),n=new Kt(e,t,F),l=new Kt(e,t,C),c=new Kt(e,t,E);this.L=l,this.R=n,this.U=h,this.B=c,n.rotate(-Qt,0,0,1),n.translate(0,r+o,0),n.rotate(2*Qt,0,0,1),h.rotate(Qt,0,0,1),h.translate(0,r+o,0),h.rotate(-2*Qt,0,0,1),c.rotate(3*Qt,0,0,1),c.translate(0,r+o,0),c.rotate(-2*Qt,0,0,1),this.faces={top:this.U,right:this.R,left:this.L,back:this.B},this.group=new Ut([h,n,l,c])}setColors(t){let{left:e,right:r,top:o,back:h}=t;this.setFaceColors(this.L,e),this.setFaceColors(this.R,r),this.setFaceColors(this.U,o),this.setFaceColors(this.B,h)}setFaceColors(t,e){t.faces.forEach(((t,i)=>{e&&e[i]?t.color=e[i]:t.color=P}))}}const ts=Math.acos(1/3),ss=120*Math.PI/180,es=Math.sqrt(24);class is{constructor(t,e=1.75){this.size=t;const r=e/es,o=new Kt(e,t,k),h=new Kt(e,t,F),n=new Kt(e,t,C),l=new Kt(e,t,E);this.L=n,this.R=h,this.U=o,this.B=l,o.rotate(ss,0,0,1),o.rotate(ts,1,0,0),o.translate(0,0,r),h.rotate(ts,1,0,0),h.translate(0,0,r),n.rotate(-ss,0,0,1),n.rotate(ts,1,0,0),n.translate(0,0,r),l.rotate(Math.PI,0,1,0),l.translate(0,0,r),this.faces={top:this.U,right:this.R,left:this.L,back:this.B},this.group=new Ut([o,n,h,l])}setColors(t){let{left:e,right:r,top:o,back:h}=t;this.setFaceColors(this.L,e),this.setFaceColors(this.R,r),this.setFaceColors(this.U,o),this.setFaceColors(this.B,h)}setFaceColors(t,e){t.faces.forEach(((t,i)=>{e&&e[i]?t.color=e[i]:t.color=P}))}}class rs extends $t{constructor(t,e=2,r=1.6,o=.4){const h=function(t){return t/(2*Math.sin(Math.PI/5))}(r),n=function(t){const e=t*t,r=71*Math.PI/180,o=2*e-2*e*Math.cos(r);return 2*Math.sqrt(Math.abs(e-o))}(o),l=function(t,e,r,o){let h=[];for(let i=0;i<t;i++){const t=e+r*i;h=[...h,...ns(i,t,o)]}return h}(e,h-n*(e-1),n,o);super(l,function(t,e,r){let o=[];const h=new Dt([0,1,2,3,4],r,e);o.push(h);let n=5,l=5;for(let i=1;i<t;i++){const t=5+10*i;n+=t;const h=os(i),c=as(i-1),d=as(i);for(;l<n;){const n=l-(c[c.length-1]+1);if(n%(t/5)==0){l++;continue}const f=(n+1)%(t/5)==0;let m=l,w=d[(n+1)%d.length],v=f?w+1:h.shift(),y=f?h.shift():c[(c.indexOf(v)-1+c.length)%c.length];l++,o.push(new Dt([m,w,v,y],r,e))}}return o}(e,t,l))}}function os(t){if(t<1)return[];let e=[];const r=5+10*(t-1);let o=5*(t-1)*(t-1);for(let i=0;i<r;i++)e.push(i+o),i%(r/5)==0&&e.push(i+o);return e.push(e.shift()),e.push(e.shift()),e}function as(t){let e=5*t*t,r=[];for(let i=0,o=5+10*t;i<o;i++)r.push(i+e);return r}function hs(t,e,r,o){if(0===r)return[U.fromValues(t.x,t.y,0),U.fromValues(e.x,e.y,0)];const h=function(t,e){return Math.sqrt(Math.pow(e.y-t.y,2)+Math.pow(e.x-t.x,2))}(t,e);let n=[];for(let i=r;i>0;i--){let a=U.fromValues(t.x+(e.x-t.x)/h*o*i,t.y+(e.y-t.y)/h*o*i,0);n.unshift(a);let b=U.fromValues(e.x+(t.x-e.x)/h*o*i,e.y+(t.y-e.y)/h*o*i,0);n.push(b)}return n.unshift(U.fromValues(t.x,t.y,0)),n.push(U.fromValues(e.x,e.y,0)),n}function ns(t,e,r){let o=[];for(let i=0;i<5;i++){const h=Lt(e,i*(2*Math.PI)/5-Math.PI/10);if(o.length>0){const e=o[o.length-1],n=hs(A.fromValues(e.x,e.y),h,t,r);n.shift(),o=o.concat(n)}else o.push(U.fromValues(h.x,h.y,0))}const h=o[0],n=o[o.length-1],l=hs(A.fromValues(n.x,n.y),A.fromValues(h.x,h.y),t,r);return l.pop(),l.shift(),o=o.concat(l),o}const ls=36*Math.PI/180,cs=72*Math.PI/180,us={2:.3,3:.17,4:.121};class ds{constructor(t){this.layers=t;const e=.75,r=function(t,e){return us[e]||t/(1.9*e)}(length,t);this.U=new rs(M,t,e,r),this.F=new rs(E,t,e,r),this.R=new rs(C,t,e,r),this.L=new rs(F,t,e,r),this.dl=new rs(T,t,e,r),this.dr=new rs(x,t,e,r),this.BL=new rs(S,t,e,r),this.BR=new rs(k,t,e,r),this.d=new rs(B,t,e,r),this.bl=new rs(L,t,e,r),this.br=new rs(I,t,e,r),this.b=new rs(R,t,e,r);const o=2*function(t){return t/(2*Math.tan(Math.PI/5))}(e);this.U.translate(0,o,0),this.U.rotate(5*ls,0,0,1),this.R.rotate(-cs,0,0,1),this.R.translate(0,o,0),this.R.rotate(5*ls,0,0,1),this.L.rotate(cs,0,0,1),this.L.translate(0,o,0),this.L.rotate(-5*ls,0,0,1),this.dl.rotate(2*cs,0,0,1),this.dl.translate(0,o,0),this.dl.rotate(-5*ls,0,0,1),this.dr.rotate(-2*cs,0,0,1),this.dr.translate(0,o,0),this.dr.rotate(-5*ls,0,0,1),this.b.rotate(Math.PI,0,0,1),this.b.rotate(-2*ls,0,0,1),this.d.rotate(3*ls,0,0,1),this.d.translate(0,o,0),this.d.rotate(5*ls,0,0,1),this.br.rotate(ls,0,0,1),this.br.translate(0,o,0),this.br.rotate(5*ls,0,0,1),this.BR.rotate(-ls,0,0,1),this.BR.translate(0,o,0),this.BR.rotate(-5*ls,0,0,1),this.BL.rotate(-3*ls,0,0,1),this.BL.translate(0,o,0),this.BL.rotate(5*ls,0,0,1),this.bl.rotate(5*ls,0,0,1),this.bl.translate(0,o,0),this.bl.rotate(-5*ls,0,0,1);let h=new Nt;h.rotate(-cs,0,0,1),h.translate(0,2*o,0),h.rotate(2*cs,0,0,1),h.translate(0,-o,0),[this.d,this.bl,this.BL,this.BR,this.br,this.b].forEach((t=>{Nt.multiply(t.matrix,h,t.matrix)})),this.faces={U:this.U,F:this.F,R:this.R,dr:this.dr,dl:this.dl,L:this.L,d:this.d,br:this.br,BR:this.BR,BL:this.BL,bl:this.bl,b:this.b},this.group=new Ut([this.U,this.F,this.L,this.dr,this.dl,this.R,this.d,this.bl,this.BL,this.BR,this.br,this.b]),this.group.scale(.33,.33,.33),this.group.translate(-1.3125,0,0)}setColors(t){let{U:e,R:r,F:o,d:h,L:n,b:b,dr:l,dl:dl,br:br,BR:c,BL:d,bl:f}=t;this.setFaceColors(this.U,e),this.setFaceColors(this.R,r),this.setFaceColors(this.F,o),this.setFaceColors(this.d,h),this.setFaceColors(this.L,n),this.setFaceColors(this.b,b),this.setFaceColors(this.dr,l),this.setFaceColors(this.dl,dl),this.setFaceColors(this.BR,c),this.setFaceColors(this.BL,d),this.setFaceColors(this.bl,f),this.setFaceColors(this.br,br)}oldSetColors(t){const e=this.layers,r=5*e*e-5*e+1;let[o,h,n,l,dl,c,d,br,f,m,w,b]=function(t,e){const r=Math.ceil(t.length/e);return new Array(r).fill(null).map(((r,o)=>t.slice(o*e,(o+1)*e)))}(t,r);this.setFaceColors(this.U,o),this.setFaceColors(this.R,h),this.setFaceColors(this.F,n),this.setFaceColors(this.d,d),this.setFaceColors(this.L,c),this.setFaceColors(this.b,b),this.setFaceColors(this.dr,l),this.setFaceColors(this.dl,dl),this.setFaceColors(this.br,br),this.setFaceColors(this.BR,f),this.setFaceColors(this.BL,m),this.setFaceColors(this.bl,w)}setFaceColors(t,e){t.faces.forEach(((t,i)=>{e&&e[i]?t.color=e[i]:t.color=P}))}}const fs={2:.3,3:.17,4:.121};class ms{constructor(t=2){this.layers=t;const e=.75,r=Tt(e),o=function(t,e){return fs[e]||t/(1.9*e)}(e,t);this.U=new rs(M,t,e,o),this.F=new rs(E,t,e,o),this.R=new rs(C,t,e,o),this.dr=new rs(x,t,e,o),this.dl=new rs(T,t,e,o),this.L=new rs(F,t,e,o),this.d=new rs(B,t,e,o),this.br=new rs(I,t,e,o),this.BR=new rs(k,t,e,o),this.BL=new rs(S,t,e,o),this.bl=new rs(L,t,e,o),this.b=new rs(R,t,e,o),this.F.translate(0,0,r),this.b.rotate(Math.PI,0,0,1),this.b.rotate(Math.PI,0,1,0),this.b.translate(0,0,r),this.U.rotate(Math.PI,0,0,1),this.U.rotate((180-116.57)*Math.PI/180,1,0,0),this.U.translate(0,0,r),this.L.rotate(72*Math.PI/180,0,0,1),this.L.rotate(Math.PI,0,0,1),this.L.rotate((180-116.57)*Math.PI/180,1,0,0),this.L.translate(0,0,r),this.R.rotate(72*Math.PI/180,0,0,1),this.R.rotate(Math.PI/5,0,0,1),this.R.rotate((180-116.57)*Math.PI/180,1,0,0),this.R.translate(0,0,r),this.dr.rotate(72*Math.PI/180,0,0,1),this.dr.rotate(-Math.PI/5,0,0,1),this.dr.rotate((180-116.57)*Math.PI/180,1,0,0),this.dr.translate(0,0,r),this.dl.rotate(72*Math.PI/180,0,0,1),this.dl.rotate(-3*Math.PI/5,0,0,1),this.dl.rotate((180-116.57)*Math.PI/180,1,0,0),this.dl.translate(0,0,r),this.BL.rotate(Math.PI/5,0,0,1),this.BL.rotate(-116.57*Math.PI/180,1,0,0),this.BL.translate(0,0,r),this.BR.rotate(-Math.PI/5,0,0,1),this.BR.rotate(-116.57*Math.PI/180,1,0,0),this.BR.translate(0,0,r),this.bl.rotate(3*Math.PI/5,0,0,1),this.bl.rotate(-116.57*Math.PI/180,1,0,0),this.bl.translate(0,0,r),this.d.rotate(5*Math.PI/5,0,0,1),this.d.rotate(-116.57*Math.PI/180,1,0,0),this.d.translate(0,0,r),this.br.rotate(7*Math.PI/5,0,0,1),this.br.rotate(-116.57*Math.PI/180,1,0,0),this.br.translate(0,0,r),this.stickers=[this.U,this.F,this.R,this.dr,this.dl,this.L,this.d,this.br,this.BR,this.BL,this.bl,this.b],this.faces={U:this.U,F:this.F,R:this.R,dr:this.dr,dl:this.dl,L:this.L,d:this.d,br:this.br,BR:this.BR,BL:this.BL,bl:this.bl,b:this.b},this.group=new Ut(this.stickers)}setColors(t){let{U:e,R:r,F:o,d:h,L:n,b:b,dr:l,dl:dl,br:br,BR:c,BL:d,bl:f}=t;this.setFaceColors(this.U,e),this.setFaceColors(this.R,r),this.setFaceColors(this.F,o),this.setFaceColors(this.d,h),this.setFaceColors(this.L,n),this.setFaceColors(this.b,b),this.setFaceColors(this.dr,l),this.setFaceColors(this.dl,dl),this.setFaceColors(this.BR,c),this.setFaceColors(this.BL,d),this.setFaceColors(this.bl,f),this.setFaceColors(this.br,br)}setFaceColors(t,e){t.faces.forEach(((t,i)=>{e&&e[i]?t.color=e[i]:t.color=P}))}}function ps(t,e,r){const o=t/2,h=t/e,n=h/2;let l=[];for(let i=0;i<e;i++){let c=-(-o+n+h*i);l=l.concat(bs(t,e,r,c))}return l}function bs(t,e,r,o=0){const h=t/2,n=t/e,l=n/2;let c=[];for(let i=0;i<e;i++){let t=-h+l+n*i,e=[U.fromValues(-l+t,l+o,0),U.fromValues(l+t,l+o,0),U.fromValues(l+t,-l+o,0),U.fromValues(-l+t,-l+o,0)],d=[new Dt([0,1,2,3],e,r)];c.push(new $t(e,d))}return c}class ws{constructor(t,e=Math.PI/4){this.size=t,this.cubeWidth=1.45,this.halfCubeWidth=this.cubeWidth/2,this.stickerWidth=this.cubeWidth/t,this.halfStickerWidth=this.stickerWidth/2,this.cubeWidth=this.stickerWidth*t,this.U=new Ut(ps(this.cubeWidth,this.size,k)),this.R=new Ut(bs(this.cubeWidth,this.size,E)),this.F=new Ut(bs(this.cubeWidth,this.size,C)),this.B=new Ut(bs(this.cubeWidth,this.size,F)),this.L=new Ut(bs(this.cubeWidth,this.size,R));const r=this.halfCubeWidth+this.halfStickerWidth;this.B.translate(0,r,0),this.B.rotate(Math.PI,0,0,1),this.F.translate(0,-r,0),this.R.translate(r,0,0),this.R.rotate(Math.PI/2,0,0,1),this.L.translate(-r,0,0),this.L.rotate(-Math.PI/2,0,0,1),this.rotateBorder(this.F.objects,e),this.rotateBorder(this.R.objects,e),this.rotateBorder(this.B.objects,e),this.rotateBorder(this.L.objects,e),this.stickers=[this.U,this.R,this.F,this.B,this.L],this.group=new Ut(this.stickers),this.faces={U:this.U,R:this.R,F:this.F,L:this.L,B:this.B}}setFaceColors(t,e){t.objects.forEach(((g,i)=>{e&&e[i]?g.faces[0].color=e[i]:g.faces[0].color=P}))}setColors(t){let{U:e,R:r,F:o,L:h,B:n}=t;this.setFaceColors(this.U,e),this.setFaceColors(this.R,r),this.setFaceColors(this.F,o),this.setFaceColors(this.L,h),this.setFaceColors(this.B,n)}rotateBorder(t,e){t.forEach((t=>{t.vertices=t.vertices.map((t=>t.rotateX(U.fromValues(0,this.halfStickerWidth,0),e))),t.centroid=It(t.vertices)}))}}class vs{constructor(t){this.size=t;const e=ps(1,t,k),r=ps(1,t,E),o=ps(1,t,C),h=ps(1,t,M),n=ps(1,t,R),l=ps(1,t,F);this.U=new Ut(e),this.U.translate(0,1,0),this.R=new Ut(r),this.R.translate(1,0,0),this.F=new Ut(o),this.D=new Ut(h),this.D.translate(0,-1,0),this.L=new Ut(n),this.L.translate(-1,0,0),this.B=new Ut(l),this.B.translate(2,0,0),this.stickers=[this.U,this.R,this.F,this.D,this.L,this.B],this.faces={U:this.U,R:this.R,F:this.F,D:this.D,L:this.L,B:this.B},this.group=new Ut(this.stickers),this.group.translate(-1/4,0,0),this.group.scale(.5,.5,.5)}setFaceColors(t,e){t.objects.forEach(((g,i)=>{e&&e[i]?g.faces[0].color=e[i]:g.faces[0].color=P}))}setColors(t){let{U:e,R:r,F:o,D:h,L:n,B:l}=t;this.setFaceColors(this.U,e),this.setFaceColors(this.R,r),this.setFaceColors(this.F,o),this.setFaceColors(this.D,h),this.setFaceColors(this.L,n),this.setFaceColors(this.B,l)}}class gs{constructor(t){this.size=t;const e=1.25,r=.625;this.U=new Ut(ps(e,t,k)),this.R=new Ut(ps(e,t,E)),this.F=new Ut(ps(e,t,C)),this.D=new Ut(ps(e,t,M)),this.L=new Ut(ps(e,t,R)),this.B=new Ut(ps(e,t,F)),this.U.rotate(-Math.PI/2,0,1,0),this.U.rotate(-Math.PI/2,1,0,0),this.U.translate(0,0,r),this.R.translate(0,0,r),this.F.rotate(-Math.PI/2,0,1,0),this.F.translate(0,0,r),this.D.rotate(-Math.PI/2,0,1,0),this.D.rotate(Math.PI/2,1,0,0),this.D.translate(0,0,r),this.L.rotate(-Math.PI,0,1,0),this.L.translate(0,0,r),this.B.rotate(Math.PI/2,0,1,0),this.B.translate(0,0,r),this.stickers=[this.U,this.R,this.F,this.D,this.L,this.B],this.faces={U:this.U,R:this.R,F:this.F,D:this.D,L:this.L,B:this.B},this.group=new Ut(this.stickers)}setFaceColors(t,e){t.objects.forEach(((g,i)=>{e&&e[i]?g.faces[0].color=e[i]:g.faces[0].color=P}))}setColors(t){let{U:e,R:r,F:o,D:h,L:n,B:l}=t;this.setFaceColors(this.U,e),this.setFaceColors(this.R,r),this.setFaceColors(this.F,o),this.setFaceColors(this.D,h),this.setFaceColors(this.L,n),this.setFaceColors(this.B,l)}}class ys extends zt{constructor(t,e){super(),this.p1=t,this.p2=e,this.centroid=It([t,e])}}function ks(t,e){let r=t.clone();return e.forEach(((t,i)=>{r.transformMat4(t)})),r}class Es{constructor(){this.polygons=[],this.arrows=[]}render(t,e){this.polygons=[],t.objects.forEach((object=>{this.renderObject3D(object,e,[])})),this.onBeforeRender(),this.renderPolygons(),this.renderArrows(),this.onComplete()}renderPolygons(){this.polygons.sort(((a,b)=>a.centroid.z-b.centroid.z)),this.polygons.forEach((p=>this.drawPolygon(p)))}renderArrows(){this.arrows.forEach((({p1:t,p2:e,uid:r})=>{this.drawArrow(t,e,r)}))}renderObject3D(object,t,e){if(object instanceof $t)this.renderGeometry(object,t,e);else if(object instanceof ys)this.renderArrow(object,t,e);else if(object instanceof Ut){let r=object;r.objects.forEach((object=>{this.renderObject3D(object,t,[r.matrix,...e])}))}}renderGeometry(object,t,e){object.faces.forEach((r=>{let o=[];r.indices.map((t=>object.vertices[t])).forEach((r=>{let h=ks(r,[object.matrix,...e,t.matrix]);h.multiply(1,-1,1),o.push(h)})),this.addPolygon(o,r,object,e)}))}renderArrow(object,t,e){let r=[object.matrix,...e,t.matrix],o=ks(object.p1,r),h=ks(object.p2,r);this.arrows.push({p1:o,p2:h,uid:object.uid})}addPolygon(t,e,object,r){this.polygons.push({points:t,face:e,object:object,centroid:ks(e.centroid,[object.matrix,...r])})}sortObjects(t,e,r){let o=[...t];return o.sort(((a,b)=>{let t=[a.matrix,...r],e=[b.matrix,...r],o=ks(a.centroid,t),h=ks(b.centroid,e);return o.z-h.z})),o}}function Cs(polygon,t,e,r){const o=function(t){return t.reduce(((t,e)=>`${t?t+" ":""}${e.x}, ${e.y}`),"")}(t),h=e?e.value:"black",n=e&&e.stroke||"#000000";polygon.setAttributeNS(null,"points",o),polygon.setAttributeNS(null,"fill",h),r&&(polygon.setAttributeNS(null,"stroke",n),polygon.setAttributeNS(null,"stroke-width",r)),polygon.setAttributeNS(null,"stroke-linejoin","round")}class Ms extends Es{constructor(t,e,r,o,h,n,l){super(),this.strokeWidth="0.035",this.arrowStrokeWidth="0.03",this.polygons=[],this.lines=[],this.uidToPolygon={},this.uidToLine={},this.arrowColor=l||P,this.domElement=document.createElement("div"),this.domElement.className="svg-renderer",this.svgElement=function(t,e,r,o,h,n){const l=document.createElementNS("http://www.w3.org/2000/svg","svg");return l.setAttributeNS(null,"width",t.toString()),l.setAttributeNS(null,"height",e.toString()),l.setAttributeNS(null,"viewBox",`${r} ${o} ${h} ${n}`),l.setAttributeNS(null,"id","sr-visualizer"),l}(t,e,r,o,h,n);const c=function(t){const defs=document.createElementNS("http://www.w3.org/2000/svg","defs"),e=document.createElementNS("http://www.w3.org/2000/svg","marker");e.setAttributeNS(null,"id","arrowhead"),e.setAttributeNS(null,"markerWidth","4"),e.setAttributeNS(null,"markerHeight","3.5"),e.setAttributeNS(null,"refX","3"),e.setAttributeNS(null,"refY","1.75"),e.setAttributeNS(null,"orient","auto");const r=document.createElementNS("http://www.w3.org/2000/svg","polygon");return r.setAttributeNS(null,"points","0 0, 4 1.75, 0 3.5"),r.setAttributeNS(null,"fill",t.value),defs.appendChild(e),e.appendChild(r),defs}(this.arrowColor);this.svgElement.appendChild(c),this.domElement.appendChild(this.svgElement)}onBeforeRender(){}drawPolygon({points:t,face:e,object:object}){if(this.uidToPolygon[e.uid]){Cs(this.uidToPolygon[e.uid],t,e.color||object.color,this.strokeWidth)}else this.uidToPolygon[e.uid]=function(t,e,r){const polygon=document.createElementNS("http://www.w3.org/2000/svg","polygon");return Cs(polygon,t,e,r),polygon}(t,e.color||object.color,this.strokeWidth);this.svgElement.appendChild(this.uidToPolygon[e.uid])}drawArrow(t,e,r){let o;this.uidToLine[r]?(o=this.uidToLine[r],o.setAttributeNS(null,"x1",t[0].toString()),o.setAttributeNS(null,"y1",(-t[1]).toString()),o.setAttributeNS(null,"x2",e[0].toString()),o.setAttributeNS(null,"y2",(-e[1]).toString())):(o=function(t,e,r,o){const line=document.createElementNS("http://www.w3.org/2000/svg","line");let h=r?r.value:P.value;return line.setAttributeNS(null,"x1",t.x.toString()),line.setAttributeNS(null,"y1",(-t.y).toString()),line.setAttributeNS(null,"x2",e.x.toString()),line.setAttributeNS(null,"y2",(-e.y).toString()),line.setAttributeNS(null,"stroke",h),line.setAttributeNS(null,"marker-end","url(#arrowhead)"),o&&line.setAttributeNS(null,"stroke-width",o),line}(t,e,this.arrowColor,this.arrowStrokeWidth),this.uidToLine[r]=o),this.svgElement.appendChild(this.uidToLine[r])}onComplete(){}}class Rs{constructor(){this.matrix=Nt.perspective(Math.PI/2,1,.1,1e3),this.matrix.translate(0,0,-5),this.matrix.scale(4,4,1)}}class Fs{constructor(){this.objects=[]}add(t){this.objects.push(t)}clear(){this.objects=[]}}var Ss;!function(t){t.CUBE="cube",t.CUBE_NET="cube-net",t.CUBE_TOP="cube-top",t.MEGAMINX="megaminx",t.MEGAMINX_NET="megaminx-net",t.MEGAMINX_TOP="megaminx-top",t.PYRAMINX="pyraminx",t.PYRAMINX_NET="pyraminx-net",t.SKEWB="skewb",t.SKEWB_NET="skewb-net",t.SQUARE1="square1",t.SQUARE1_NET="square1-net"}(Ss||(Ss={}));const Bs={size:3,scheme:{U:k,R:E,F:C,D:M,L:R,B:F},rotations:[{x:0,y:45,z:0},{x:34,y:0,z:0}]},Ls={size:2,scheme:{U:M,F:E,R:C,dr:x,dl:T,L:F,d:B,br:I,BR:k,BL:S,bl:L,b:R}},Ts={size:3,scheme:{left:C,right:F,top:k,back:E},rotations:[{x:0,y:0,z:60},{x:-60,y:0,z:0}]},Is={scheme:{top:k,front:C,right:E,back:F,left:R,bottom:M},rotations:[{x:0,y:45,z:0},{x:34,y:0,z:0}]},xs={scheme:G,rotations:[{x:0,y:0,z:-34},{x:-56,y:0,z:0}]};function Ps(t){if(t.alg&&"string"!=typeof t.alg&&(console.warn(`Inavlid alg ${t.alg}. alg must be a string`),t.alg=""),t.case&&"string"!=typeof t.case&&(console.warn(`Inavlid case ${t.case}. case must be a string`),t.case=""),t.scheme&&("object"!=typeof t.scheme||Array.isArray(t.scheme)?(console.warn(`Invalid scheme ${t.scheme}. scheme must be an object`),t.scheme={}):Object.keys(t.scheme).forEach((e=>{const r=t.scheme[e];null!=r&&"object"==typeof r&&r.value||(console.warn(`Invalid scheme color ${r}. must be an type IColor`),t.scheme[e]=P)}))),t.mask&&("object"!=typeof t.mask||Array.isArray(t.mask)?(console.warn(`Invalid mask ${t.mask}. scheme must be an object`),t.mask={}):Object.keys(t.mask).forEach((e=>{const r=t.mask[e];if(Array.isArray(r)){for(let i=0;i<r.length;i++)if(!Number.isInteger(r[i])){console.warn(`Invalid mask value ${r[i]}. must be a number`),t.mask[e]=[];break}}else console.warn(`Invalid mask ${r}. must be an array`),t.mask[e]=[]}))),t.stickerColors&&("object"!=typeof t.stickerColors||Array.isArray(t.stickerColors)?(console.warn(`Invalid stickerColors ${t.stickerColors}. stickerColors must be an object`),t.stickerColors={}):Object.keys(t.stickerColors).forEach((e=>{const r=t.stickerColors[e];if(Array.isArray(r)){for(let i=0;i<r.length;i++)if(!Ns(r[i])){t.stickerColors[e]=[];break}}else console.warn(`Invalid colors ${r}. must be an array`),t.stickerColors[e]=[]}))),t.rotations)if(Array.isArray(t.rotations)){for(let i=0;i<t.rotations.length;i++)if(!zs(t.rotations[i])){t.rotations=[];break}}else console.warn(`invalid rotations ${t.rotations}, must be an array`),t.rotations=[];if(t.scale&&!Number.isFinite(t.scale)&&(console.warn(`invalid scale ${t.scale}, must be a finite number`),t.scale=1),t.translation&&!function(t){if("object"!=typeof t||Array.isArray(t))return console.warn(`invalid translation ${t}, must be an object`),!1;if(t.x&&!Number.isFinite(t.x))return console.warn(`invalid x translation ${t.x}, must be a number`),!1;if(t.y&&!Number.isFinite(t.y))return console.warn(`invalid y translation ${t.y}, must be a number`),!1;if(t.z&&!Number.isFinite(t.z))return console.warn(`invalid z translation ${t.z}, must be a number`),!1;return!0}(t.translation)&&(t.translation={x:0,y:0,z:0}),t.arrows)if(Array.isArray(t.arrows)){for(let i=0;i<t.arrows.length;i++)if(!Us(t.arrows[i])){t.arrows=[];break}}else console.warn("invalid arrows, must be an array"),t.arrows=[]}function Ns(t){return"object"!=typeof t?(console.warn(`invalid color ${t}, must be type object`),!1):t.value&&"string"==typeof t.value?!t.stroke||"string"==typeof t.stroke||(console.warn(`invalid color stroke ${t.stroke}, must be type string`),!1):(console.warn(`invalid color value ${t.value}, must be type string`),!1)}function zs(t){return t&&"object"==typeof t?t.x&&!Number.isFinite(t.x)?(console.warn(`invalid x rotation ${t.x}, must be a number`),!1):t.y&&!Number.isFinite(t.y)?(console.warn(`invalid y rotation ${t.y}, must be a number`),!1):!(t.z&&!Number.isFinite(t.z))||(console.warn(`invalid z rotation ${t.z}, must be a number`),!1):(console.warn(`invalid rotation ${t}, must be an object`),!1)}function Us(a){return"object"!=typeof a?(console.warn(`invalid arrow ${a}, must be an object`),!1):"object"!=typeof a.end||"object"!=typeof a.start?(console.warn(`invalid arrow ${a}, must have start and end`),!1):"string"==typeof a.start.face&&Number.isInteger(a.start.sticker)?!("string"!=typeof a.end.face||!Number.isInteger(a.end.sticker))||(console.warn(`invalid arrow end ${a.end}`),!1):(console.warn(`invalid arrow start ${a.start}`),!1)}const As={2:.3,3:.17,4:.121};class Vs{constructor(){this.createFaces(),this.removeHiddenStickers()}createFaces(){const t=.75,e=function(t,e){return As[e]||t/(1.9*e)}(t,2),r=Tt(t);this.U=new rs(M,2,t,e),this.F=new rs(E,2,t,e),this.R=new rs(C,2,t,e),this.L=new rs(F,2,t,e),this.BR=new rs(k,2,t,e),this.BL=new rs(S,2,t,e),this.F.translate(0,0,r),this.U.rotate(Math.PI,0,0,1),this.U.rotate((180-116.57)*Math.PI/180,1,0,0),this.U.translate(0,0,r),this.L.rotate(72*Math.PI/180,0,0,1),this.L.rotate(Math.PI,0,0,1),this.L.rotate((180-116.57)*Math.PI/180,1,0,0),this.L.translate(0,0,r),this.R.rotate(72*Math.PI/180,0,0,1),this.R.rotate(Math.PI/5,0,0,1),this.R.rotate((180-116.57)*Math.PI/180,1,0,0),this.R.translate(0,0,r),this.BL.rotate(Math.PI/5,0,0,1),this.BL.rotate(-116.57*Math.PI/180,1,0,0),this.BL.translate(0,0,r),this.BR.rotate(-Math.PI/5,0,0,1),this.BR.rotate(-116.57*Math.PI/180,1,0,0),this.BR.translate(0,0,r),this.faces={U:this.U,F:this.F,R:this.R,dr:this.BR,dl:this.BL,L:this.L},this.group=new Ut([this.U,this.F,this.R,this.BR,this.BL,this.L]),this.group.rotate(Bt(63),1,0,0)}setColors(t){let{U:e,R:r,F:o,L:h,BR:n,BL:l}=t;this.createFaces(),this.setFaceColors(this.U,e),this.setFaceColors(this.R,r),this.setFaceColors(this.F,o),this.setFaceColors(this.L,h),this.setFaceColors(this.BR,n),this.setFaceColors(this.BL,l),this.removeHiddenStickers()}setFaceColors(t,e){t.faces.forEach(((t,i)=>{e&&e[i]?t.color=e[i]:t.color=P}))}removeHiddenStickers(){this.F.faces=this.F.faces.slice(2,5),this.BL.faces=this.BL.faces.slice(8,11),this.L.faces=this.L.faces.slice(4,7),this.R.faces=[this.R.faces[1],this.R.faces[2],this.R.faces[10]],this.BR.faces=this.BR.faces.slice(6,9)}}const Os={[Ss.CUBE]:{},[Ss.CUBE_NET]:{},[Ss.CUBE_TOP]:{},[Ss.MEGAMINX]:{},[Ss.MEGAMINX_NET]:{},[Ss.MEGAMINX_TOP]:{},[Ss.PYRAMINX]:{},[Ss.PYRAMINX_NET]:{},[Ss.SKEWB]:{},[Ss.SKEWB_NET]:{},[Ss.SQUARE1]:{},[Ss.SQUARE1_NET]:{}};function Ws(t,e){switch(t){case Ss.CUBE:return function(t={}){Os[Ss.CUBE][t.size]||(Os[Ss.CUBE][t.size]=new gs(t.size));return Os[Ss.CUBE][t.size]}(e);case Ss.CUBE_NET:return function(t={}){Os[Ss.CUBE_NET][t.size]||(Os[Ss.CUBE_NET][t.size]=new vs(t.size));return Os[Ss.CUBE_NET][t.size]}(e);case Ss.CUBE_TOP:return function(t={}){Os[Ss.CUBE_TOP][t.size]||(Os[Ss.CUBE_TOP][t.size]=new ws(t.size));return Os[Ss.CUBE_TOP][t.size]}(e);case Ss.MEGAMINX:return function(t={}){Os[Ss.MEGAMINX][t.size]||(Os[Ss.MEGAMINX][t.size]=new ms(t.size));return Os[Ss.MEGAMINX][t.size]}(e);case Ss.MEGAMINX_NET:return function(t={}){Os[Ss.MEGAMINX_NET][t.size]||(Os[Ss.MEGAMINX_NET][t.size]=new ds(t.size));return Os[Ss.MEGAMINX_NET][t.size]}(e);case Ss.MEGAMINX_TOP:return function(t={}){Os[Ss.MEGAMINX_TOP][2]||(Os[Ss.MEGAMINX_TOP][2]=new Vs);return Os[Ss.MEGAMINX_TOP][2]}(e);case Ss.PYRAMINX:return function(t={}){Os[Ss.PYRAMINX][t.size]||(Os[Ss.PYRAMINX][t.size]=new is(t.size));return Os[Ss.PYRAMINX][t.size]}(e);case Ss.PYRAMINX_NET:return function(t={}){Os[Ss.PYRAMINX_NET][t.size]||(Os[Ss.PYRAMINX_NET][t.size]=new Jt(t.size));return Os[Ss.PYRAMINX_NET][t.size]}(e);case Ss.SKEWB:return function(t={}){Os[Ss.SKEWB][1]||(Os[Ss.SKEWB][1]=new Zt);return Os[Ss.SKEWB][1]}(e);case Ss.SKEWB_NET:return function(t={}){Os[Ss.SKEWB_NET][1]||(Os[Ss.SKEWB_NET][1]=new qt);return Os[Ss.SKEWB_NET][1]}(e);case Ss.SQUARE1:return function(t={}){const e=js(t);return new _t(e.topLayer,e.bottomLayer,e.middleRotated,t.scheme)}(e);case Ss.SQUARE1_NET:return function(t={}){const e=js(t);return new Xt(e.topLayer,e.bottomLayer,e.middleRotated,t.scheme)}(e)}}function js(t){const e=new Q(t.scheme);return t.case?e.case(t.case):t.alg&&e.alg(t.alg),e}class Ds{constructor(a,b,t,e){this.a=a,this.b=b,this.c=t,this.d=e}static fromEuler(t,e,r){let o=Math.PI/360;t*=o,r*=o,e*=o;let h=Math.sin(t),n=Math.cos(t),l=Math.sin(e),c=Math.cos(e),d=Math.sin(r),f=Math.cos(r);return new Ds(h*c*f-n*l*d,n*l*f+h*c*d,n*c*d-h*l*f,n*c*f+h*l*d)}}function $s(t){return t===Ss.SQUARE1||t===Ss.SQUARE1_NET}function Xs(t,e){return function(t){return t===Ss.PYRAMINX||t===Ss.PYRAMINX_NET}(t)?3===e:!function(t){return t===Ss.MEGAMINX||t===Ss.MEGAMINX_NET||t===Ss.MEGAMINX_TOP}(t)||2===e}class Gs{constructor(t,e,r={}){this.type=e,this.camera=new Rs,this.scene=new Fs,this.group=new Ut,this.scene.add(this.group),this.renderer=t,this.initPuzzleOptions(r),this.puzzleGeometry=Ws(this.type,this.options),this.simulator=function(t,e){switch(t){case Ss.CUBE:case Ss.CUBE_NET:case Ss.CUBE_TOP:return new xt(e.size);case Ss.MEGAMINX:case Ss.MEGAMINX_NET:case Ss.MEGAMINX_TOP:return new yt;case Ss.PYRAMINX:case Ss.PYRAMINX_NET:return new mt;case Ss.SKEWB:case Ss.SKEWB_NET:return new it;case Ss.SQUARE1:case Ss.SQUARE1_NET:return js(e)}}(this.type,this.options),this.buildGroupMatrix(),this.applyColors(),this.addArrows(),this.group.addObject(this.puzzleGeometry.group),this.render()}applyColors(){const t=this.options.stickerColors&&!$s(this.type),e=Xs(this.type,this.options.size);if(t)this.puzzleGeometry.setColors(this.options.stickerColors);else if(e)this.applySimulatorColors();else{const t=this.puzzleGeometry.faces;Object.keys(t).forEach((e=>{const r=t[e],o=this.options.scheme[e];r instanceof $t?r.faces.forEach((t=>t.color=o)):r instanceof Ut&&r.objects.forEach((t=>t.color=o))}))}}applySimulatorColors(){this.options.mask&&this.applyMask(this.options),(this.options.alg||this.options.case)&&this.applyAlgorithm();const t=function(t,e){return Object.keys(t).reduce(((r,o)=>(r[o]=t[o].map((t=>e[t]||N)),r)),{})}(this.simulator.getValues(),this.options.scheme);this.puzzleGeometry.setColors(t)}applyAlgorithm(){$s(this.type)||(this.options.case?this.simulator.case(this.options.case):this.options.alg&&this.simulator.alg(this.options.alg))}applyMask(t){Object.keys(t.mask).forEach((e=>{t.mask[e].forEach((t=>this.simulator.setValue(e,t,"mask")))}))}buildGroupMatrix(){if(this.group.matrix=new Nt,this.options.rotations&&this.options.rotations.forEach((t=>{const{x:e=0,y:r=0,z:o=0}=t;let h=Nt.fromQuaternion(Ds.fromEuler(e,r,o));Nt.multiply(this.group.matrix,h,this.group.matrix)})),this.options.scale){let t=this.options.scale;this.group.matrix.scale(t,t,t)}if(this.options.translation){const{x:t=0,y:e=0,z:r=0}=this.options.translation;let o=Nt.fromTranslation(t,e,r);Nt.multiply(this.group.matrix,o,this.group.matrix)}}addArrows(){this.options.arrows&&this.options.arrows.forEach((t=>{try{this.scene.add(function(a,t,e){var r,o,h,n,l,c,d,f;let m=t.faces[a.start.face],w=t.faces[a.end.face];if(!m||!w)throw new Error(`Invalid arrow definition ${JSON.stringify(a)}`);let v,y,k=[m.matrix,t.group.matrix,e.matrix],E=[w.matrix,t.group.matrix,e.matrix];if(m instanceof $t&&w instanceof $t?(v=null===(r=m.faces[a.start.sticker])||void 0===r?void 0:r.centroid,y=null===(o=w.faces[a.end.sticker])||void 0===o?void 0:o.centroid):(t instanceof _t?(v=null===(h=m.objects[a.start.sticker])||void 0===h?void 0:h.faces[0].centroid,y=null===(n=w.objects[a.end.sticker])||void 0===n?void 0:n.faces[0].centroid):(v=null===(l=m.objects[a.start.sticker])||void 0===l?void 0:l.centroid,y=null===(c=w.objects[a.end.sticker])||void 0===c?void 0:c.centroid),k.unshift(null===(d=m.objects[a.start.sticker])||void 0===d?void 0:d.matrix),E.unshift(null===(f=w.objects[a.end.sticker])||void 0===f?void 0:f.matrix)),!v||!y)throw new Error(`Invalid arrow definition ${JSON.stringify(a)}`);let C=ks(v,k),M=ks(y,E);return new ys(C,M)}(t,this.puzzleGeometry,this.group))}catch(e){console.error(e),console.warn(`Invalid arrow ${JSON.stringify(t)}`)}}))}initPuzzleOptions(t){this.options=Object.assign(Object.assign({},function(t){switch(t){case Ss.CUBE:return Bs;case Ss.CUBE_NET:case Ss.CUBE_TOP:return Object.assign(Object.assign({},Bs),{rotations:null});case Ss.MEGAMINX:case Ss.MEGAMINX_NET:case Ss.MEGAMINX_TOP:return Ls;case Ss.PYRAMINX:return Ts;case Ss.PYRAMINX_NET:return Object.assign(Object.assign({},Ts),{rotations:null});case Ss.SKEWB:return Is;case Ss.SKEWB_NET:return Object.assign(Object.assign({},Is),{rotations:null});case Ss.SQUARE1:return xs;case Ss.SQUARE1_NET:return Object.assign(Object.assign({},xs),{rotations:null});default:throw new Error(`Could not get default options for puzzle ${t}`)}}(this.type)),t),Ps(this.options)}applyOptionsToPuzzle(){this.simulator.reset(),this.buildGroupMatrix(),this.applyColors(),this.addArrows()}setPuzzleOptions(t){this.initPuzzleOptions(t),$s(this.type)&&(this.puzzleGeometry=Ws(this.type,this.options),this.group.setObjects([this.puzzleGeometry.group])),this.applyOptionsToPuzzle()}render(){this.renderer.render(this.scene,this.camera)}}const _s={width:500,height:500,minx:-.9,miny:-.9,svgWidth:1.8,svgHeight:1.8,strokeWidth:.02,arrowColor:B,arrowStrokeWidth:.03};class Hs extends Gs{constructor(element,t,e={}){if(e=Object.assign(Object.assign({},_s),e),"string"==typeof element&&null===(element=document.querySelector(element)))throw new Error(`Could not find visuzlier element by query selector: ${element}`);const r=new Ms(e.width,e.height,e.minx,e.miny,e.svgWidth,e.svgHeight,e.arrowColor);r.strokeWidth=""+e.strokeWidth,element.appendChild(r.domElement),super(r,t,e.puzzle),this.svgOptions=e}setStrokeWidth(t){this.svgOptions.strokeWidth=t,this.renderer.strokeWidth=""+this.svgOptions.strokeWidth,this.render()}setSvgOptions(t){this.svgOptions=Object.assign(Object.assign({},_s),t),function(t){Number.isInteger(t.width)||(console.warn(`invalid svg width ${t.width}. Must be a whole number`),t.width=_s.width);Number.isInteger(t.height)||(console.warn(`invalid svg height ${t.height}. Must be a whole number`),t.width=_s.height);Number.isFinite(t.minx)||(console.warn(`invalid svg minx ${t.minx}`),t.minx=_s.minx);Number.isFinite(t.miny)||(console.warn(`invalid svg miny ${t.miny}`),t.minx=_s.miny);Number.isFinite(t.svgWidth)||(console.warn(`invalid svgWidth ${t.svgWidth}`),t.minx=_s.svgWidth);Number.isFinite(t.svgHeight)||(console.warn(`invalid svgHeight ${t.svgHeight}`),t.minx=_s.svgHeight);Number.isFinite(t.strokeWidth)||(console.warn(`invalid strokeWidth ${t.strokeWidth}`),t.minx=_s.strokeWidth);Number.isFinite(t.arrowStrokeWidth)||(console.warn(`invalid arrowStrokeWidth ${t.arrowStrokeWidth}`),t.minx=_s.arrowStrokeWidth);t.arrowColor&&!Ns(t.arrowColor)&&(t.arrowColor=P)}(this.svgOptions);const e=this.renderer,r=e.svgElement;e.strokeWidth=""+this.svgOptions.strokeWidth,e.arrowStrokeWidth=""+this.svgOptions.arrowStrokeWidth,r.setAttributeNS(null,"width",this.svgOptions.width.toString()),r.setAttributeNS(null,"height",this.svgOptions.width.toString()),r.setAttributeNS(null,"viewBox",`${this.svgOptions.minx} ${this.svgOptions.miny} ${this.svgOptions.svgWidth} ${this.svgOptions.svgHeight}`),this.render()}}const Ys={width:500,height:500,minx:-.9,miny:-.9,svgWidth:1.8,svgHeight:1.8,strokeWidth:.02,arrowColor:B,arrowStrokeWidth:.03};function qs(t,e,r={}){if("string"==typeof t&&null===(t=document.querySelector(t)))throw new Error(`Could not find visuzlier element by query selector: ${t}`);let element=document.createElement("div");r=Object.assign(Object.assign({},Ys),r),function(element,t,e={}){new Hs(element,t,e)}(element,e,r),setTimeout((()=>{let e=element.querySelector("svg"),o=document.createElement("img");t.appendChild(o);let canvas=document.createElement("canvas"),h=canvas.getContext("2d"),n=new Image;n.width=canvas.width=o.width=r.width,n.height=canvas.height=o.height=r.height,n.onload=function(){h.drawImage(n,0,0,n.width,n.height),o.src=canvas.toDataURL()};var l=(new XMLSerializer).serializeToString(e);n.src=`data:image/svg+xml,${encodeURIComponent(l)}`}))}}}]);